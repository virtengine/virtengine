syntax = "proto3";
package virtengine.veid.v1;

import "gogoproto/gogo.proto";
import "cosmos_proto/cosmos.proto";
import "amino/amino.proto";

option go_package = "github.com/virtengine/virtengine/sdk/go/node/veid/v1";

// ScopeType represents the type of identity scope
enum ScopeType {
  option (gogoproto.goproto_enum_prefix) = false;

  // SCOPE_TYPE_UNSPECIFIED represents an unspecified scope type
  SCOPE_TYPE_UNSPECIFIED = 0 [(gogoproto.enumvalue_customname) = "ScopeTypeUnspecified"];
  
  // SCOPE_TYPE_ID_DOCUMENT represents government-issued ID documents
  SCOPE_TYPE_ID_DOCUMENT = 1 [(gogoproto.enumvalue_customname) = "ScopeTypeIDDocument"];
  
  // SCOPE_TYPE_SELFIE represents a selfie photo for face verification
  SCOPE_TYPE_SELFIE = 2 [(gogoproto.enumvalue_customname) = "ScopeTypeSelfie"];
  
  // SCOPE_TYPE_FACE_VIDEO represents a video for liveness detection
  SCOPE_TYPE_FACE_VIDEO = 3 [(gogoproto.enumvalue_customname) = "ScopeTypeFaceVideo"];
  
  // SCOPE_TYPE_BIOMETRIC represents biometric data (fingerprint, voice, etc.)
  SCOPE_TYPE_BIOMETRIC = 4 [(gogoproto.enumvalue_customname) = "ScopeTypeBiometric"];
  
  // SCOPE_TYPE_SSO_METADATA represents SSO provider metadata pointers
  SCOPE_TYPE_SSO_METADATA = 5 [(gogoproto.enumvalue_customname) = "ScopeTypeSSOMetadata"];
  
  // SCOPE_TYPE_EMAIL_PROOF represents email verification proof
  SCOPE_TYPE_EMAIL_PROOF = 6 [(gogoproto.enumvalue_customname) = "ScopeTypeEmailProof"];
  
  // SCOPE_TYPE_SMS_PROOF represents SMS/phone verification proof
  SCOPE_TYPE_SMS_PROOF = 7 [(gogoproto.enumvalue_customname) = "ScopeTypeSMSProof"];
  
  // SCOPE_TYPE_DOMAIN_VERIFY represents domain ownership verification
  SCOPE_TYPE_DOMAIN_VERIFY = 8 [(gogoproto.enumvalue_customname) = "ScopeTypeDomainVerify"];
  
  // SCOPE_TYPE_AD_SSO represents Active Directory SSO verification
  SCOPE_TYPE_AD_SSO = 9 [(gogoproto.enumvalue_customname) = "ScopeTypeADSSO"];

  // SCOPE_TYPE_BIOMETRIC_HARDWARE represents biometric hardware attestation payloads
  SCOPE_TYPE_BIOMETRIC_HARDWARE = 10 [(gogoproto.enumvalue_customname) = "ScopeTypeBiometricHardware"];

  // SCOPE_TYPE_DEVICE_ATTESTATION represents device integrity attestation payloads
  SCOPE_TYPE_DEVICE_ATTESTATION = 11 [(gogoproto.enumvalue_customname) = "ScopeTypeDeviceAttestation"];

  // SCOPE_TYPE_SOCIAL_MEDIA represents social media profile scope metadata
  SCOPE_TYPE_SOCIAL_MEDIA = 12 [(gogoproto.enumvalue_customname) = "ScopeTypeSocialMedia"];
}

// SocialMediaProvider represents supported social media providers
enum SocialMediaProvider {
  option (gogoproto.goproto_enum_prefix) = false;

  // SOCIAL_MEDIA_PROVIDER_UNSPECIFIED represents an unspecified provider
  SOCIAL_MEDIA_PROVIDER_UNSPECIFIED = 0 [(gogoproto.enumvalue_customname) = "SocialMediaProviderUnspecified"];

  // SOCIAL_MEDIA_PROVIDER_GOOGLE represents Google social profile data
  SOCIAL_MEDIA_PROVIDER_GOOGLE = 1 [(gogoproto.enumvalue_customname) = "SocialMediaProviderGoogle"];

  // SOCIAL_MEDIA_PROVIDER_FACEBOOK represents Facebook social profile data
  SOCIAL_MEDIA_PROVIDER_FACEBOOK = 2 [(gogoproto.enumvalue_customname) = "SocialMediaProviderFacebook"];

  // SOCIAL_MEDIA_PROVIDER_MICROSOFT represents Microsoft social profile data
  SOCIAL_MEDIA_PROVIDER_MICROSOFT = 3 [(gogoproto.enumvalue_customname) = "SocialMediaProviderMicrosoft"];
}

// VerificationStatus represents the verification state of an identity scope
enum VerificationStatus {
  option (gogoproto.goproto_enum_prefix) = false;

  // VERIFICATION_STATUS_UNKNOWN indicates an uninitialized or unknown status
  VERIFICATION_STATUS_UNKNOWN = 0 [(gogoproto.enumvalue_customname) = "VerificationStatusUnknown"];
  
  // VERIFICATION_STATUS_PENDING indicates the scope is awaiting verification
  VERIFICATION_STATUS_PENDING = 1 [(gogoproto.enumvalue_customname) = "VerificationStatusPending"];
  
  // VERIFICATION_STATUS_IN_PROGRESS indicates verification is actively being processed
  VERIFICATION_STATUS_IN_PROGRESS = 2 [(gogoproto.enumvalue_customname) = "VerificationStatusInProgress"];
  
  // VERIFICATION_STATUS_VERIFIED indicates the scope has been successfully verified
  VERIFICATION_STATUS_VERIFIED = 3 [(gogoproto.enumvalue_customname) = "VerificationStatusVerified"];
  
  // VERIFICATION_STATUS_REJECTED indicates the scope failed verification
  VERIFICATION_STATUS_REJECTED = 4 [(gogoproto.enumvalue_customname) = "VerificationStatusRejected"];
  
  // VERIFICATION_STATUS_EXPIRED indicates the verification has expired
  VERIFICATION_STATUS_EXPIRED = 5 [(gogoproto.enumvalue_customname) = "VerificationStatusExpired"];
  
  // VERIFICATION_STATUS_NEEDS_ADDITIONAL_FACTOR indicates borderline score requires MFA
  VERIFICATION_STATUS_NEEDS_ADDITIONAL_FACTOR = 6 [(gogoproto.enumvalue_customname) = "VerificationStatusNeedsAdditionalFactor"];
  
  // VERIFICATION_STATUS_ADDITIONAL_FACTOR_PENDING indicates MFA challenge is in progress
  VERIFICATION_STATUS_ADDITIONAL_FACTOR_PENDING = 7 [(gogoproto.enumvalue_customname) = "VerificationStatusAdditionalFactorPending"];
}

// IdentityTier represents the verification tier of an identity
enum IdentityTier {
  option (gogoproto.goproto_enum_prefix) = false;

  // IDENTITY_TIER_UNVERIFIED is the initial state with no verification
  IDENTITY_TIER_UNVERIFIED = 0 [(gogoproto.enumvalue_customname) = "IdentityTierUnverified"];
  
  // IDENTITY_TIER_BASIC is for minimally verified identities (score 50-69)
  IDENTITY_TIER_BASIC = 1 [(gogoproto.enumvalue_customname) = "IdentityTierBasic"];
  
  // IDENTITY_TIER_STANDARD is for standard verified identities (score 70-84)
  IDENTITY_TIER_STANDARD = 2 [(gogoproto.enumvalue_customname) = "IdentityTierStandard"];
  
  // IDENTITY_TIER_PREMIUM is for premium verified identities (score 85-100)
  IDENTITY_TIER_PREMIUM = 3 [(gogoproto.enumvalue_customname) = "IdentityTierPremium"];
}

// AccountStatus represents the overall account verification status
enum AccountStatus {
  option (gogoproto.goproto_enum_prefix) = false;

  // ACCOUNT_STATUS_UNKNOWN indicates an uninitialized status
  ACCOUNT_STATUS_UNKNOWN = 0 [(gogoproto.enumvalue_customname) = "AccountStatusUnknown"];
  
  // ACCOUNT_STATUS_PENDING indicates verification is in progress
  ACCOUNT_STATUS_PENDING = 1 [(gogoproto.enumvalue_customname) = "AccountStatusPending"];
  
  // ACCOUNT_STATUS_IN_PROGRESS indicates active ML scoring
  ACCOUNT_STATUS_IN_PROGRESS = 2 [(gogoproto.enumvalue_customname) = "AccountStatusInProgress"];
  
  // ACCOUNT_STATUS_VERIFIED indicates account is verified
  ACCOUNT_STATUS_VERIFIED = 3 [(gogoproto.enumvalue_customname) = "AccountStatusVerified"];
  
  // ACCOUNT_STATUS_REJECTED indicates verification was rejected
  ACCOUNT_STATUS_REJECTED = 4 [(gogoproto.enumvalue_customname) = "AccountStatusRejected"];
  
  // ACCOUNT_STATUS_EXPIRED indicates verification has expired
  ACCOUNT_STATUS_EXPIRED = 5 [(gogoproto.enumvalue_customname) = "AccountStatusExpired"];
  
  // ACCOUNT_STATUS_NEEDS_ADDITIONAL_FACTOR indicates additional verification needed
  ACCOUNT_STATUS_NEEDS_ADDITIONAL_FACTOR = 6 [(gogoproto.enumvalue_customname) = "AccountStatusNeedsAdditionalFactor"];
}

// WalletStatus represents the overall status of an identity wallet
enum WalletStatus {
  option (gogoproto.goproto_enum_prefix) = false;

  // WALLET_STATUS_UNSPECIFIED indicates an unspecified status
  WALLET_STATUS_UNSPECIFIED = 0 [(gogoproto.enumvalue_customname) = "WalletStatusUnspecified"];
  
  // WALLET_STATUS_ACTIVE indicates the wallet is active and usable
  WALLET_STATUS_ACTIVE = 1 [(gogoproto.enumvalue_customname) = "WalletStatusActive"];
  
  // WALLET_STATUS_SUSPENDED indicates the wallet is temporarily suspended
  WALLET_STATUS_SUSPENDED = 2 [(gogoproto.enumvalue_customname) = "WalletStatusSuspended"];
  
  // WALLET_STATUS_REVOKED indicates the wallet has been revoked
  WALLET_STATUS_REVOKED = 3 [(gogoproto.enumvalue_customname) = "WalletStatusRevoked"];
  
  // WALLET_STATUS_EXPIRED indicates the wallet verification has expired
  WALLET_STATUS_EXPIRED = 4 [(gogoproto.enumvalue_customname) = "WalletStatusExpired"];
}

// ScopeRefStatus represents the status of a scope reference within a wallet
enum ScopeRefStatus {
  option (gogoproto.goproto_enum_prefix) = false;

  // SCOPE_REF_STATUS_UNSPECIFIED indicates an unspecified status
  SCOPE_REF_STATUS_UNSPECIFIED = 0 [(gogoproto.enumvalue_customname) = "ScopeRefStatusUnspecified"];
  
  // SCOPE_REF_STATUS_ACTIVE indicates the scope reference is active
  SCOPE_REF_STATUS_ACTIVE = 1 [(gogoproto.enumvalue_customname) = "ScopeRefStatusActive"];
  
  // SCOPE_REF_STATUS_REVOKED indicates the scope reference has been revoked
  SCOPE_REF_STATUS_REVOKED = 2 [(gogoproto.enumvalue_customname) = "ScopeRefStatusRevoked"];
  
  // SCOPE_REF_STATUS_EXPIRED indicates the scope reference has expired
  SCOPE_REF_STATUS_EXPIRED = 3 [(gogoproto.enumvalue_customname) = "ScopeRefStatusExpired"];
  
  // SCOPE_REF_STATUS_PENDING indicates the scope is pending verification
  SCOPE_REF_STATUS_PENDING = 4 [(gogoproto.enumvalue_customname) = "ScopeRefStatusPending"];
}

// EncryptedPayloadEnvelope is the canonical encrypted payload structure
// for all sensitive fields stored on-chain.
message EncryptedPayloadEnvelope {
  option (gogoproto.equal) = true;

  // Version is the envelope format version for future compatibility
  uint32 version = 1 [
    (gogoproto.jsontag) = "version",
    (gogoproto.moretags) = "yaml:\"version\""
  ];

  // AlgorithmID identifies the encryption algorithm used
  string algorithm_id = 2 [
    (gogoproto.jsontag) = "algorithm_id",
    (gogoproto.moretags) = "yaml:\"algorithm_id\""
  ];

  // AlgorithmVersion is the version of the algorithm used
  uint32 algorithm_version = 3 [
    (gogoproto.jsontag) = "algorithm_version",
    (gogoproto.moretags) = "yaml:\"algorithm_version\""
  ];

  // RecipientKeyIDs are the fingerprints of intended recipients' public keys
  repeated string recipient_key_ids = 4 [
    (gogoproto.jsontag) = "recipient_key_ids",
    (gogoproto.moretags) = "yaml:\"recipient_key_ids\""
  ];

  // RecipientPublicKeys are the public keys for intended recipients
  repeated bytes recipient_public_keys = 5 [
    (gogoproto.jsontag) = "recipient_public_keys",
    (gogoproto.moretags) = "yaml:\"recipient_public_keys\""
  ];

  // EncryptedKeys contains the data encryption key encrypted for each recipient
  repeated bytes encrypted_keys = 6 [
    (gogoproto.jsontag) = "encrypted_keys",
    (gogoproto.moretags) = "yaml:\"encrypted_keys\""
  ];

  // Nonce is the initialization vector / nonce for encryption
  bytes nonce = 7 [
    (gogoproto.jsontag) = "nonce",
    (gogoproto.moretags) = "yaml:\"nonce\""
  ];

  // Ciphertext is the encrypted payload data
  bytes ciphertext = 8 [
    (gogoproto.jsontag) = "ciphertext",
    (gogoproto.moretags) = "yaml:\"ciphertext\""
  ];

  // SenderSignature is the signature over the envelope contents
  bytes sender_signature = 9 [
    (gogoproto.jsontag) = "sender_signature",
    (gogoproto.moretags) = "yaml:\"sender_signature\""
  ];

  // SenderPubKey is the sender's public key for signature verification
  bytes sender_pub_key = 10 [
    (gogoproto.jsontag) = "sender_pub_key",
    (gogoproto.moretags) = "yaml:\"sender_pub_key\""
  ];

  // Metadata contains optional public or encrypted metadata
  map<string, string> metadata = 11 [
    (gogoproto.jsontag) = "metadata",
    (gogoproto.moretags) = "yaml:\"metadata\""
  ];
}

// UploadMetadata contains metadata about an identity scope upload
message UploadMetadata {
  option (gogoproto.equal) = true;

  // Salt is a per-upload unique salt for cryptographic binding
  bytes salt = 1 [
    (gogoproto.jsontag) = "salt",
    (gogoproto.moretags) = "yaml:\"salt\""
  ];

  // SaltHash is the SHA256 hash of the salt
  bytes salt_hash = 2 [
    (gogoproto.jsontag) = "salt_hash",
    (gogoproto.moretags) = "yaml:\"salt_hash\""
  ];

  // DeviceFingerprint is a hash/identifier of the device used for upload
  string device_fingerprint = 3 [
    (gogoproto.jsontag) = "device_fingerprint",
    (gogoproto.moretags) = "yaml:\"device_fingerprint\""
  ];

  // ClientID is the identifier of the approved client
  string client_id = 4 [
    (gogoproto.jsontag) = "client_id",
    (gogoproto.moretags) = "yaml:\"client_id\""
  ];

  // ClientSignature is the cryptographic signature from the approved client
  bytes client_signature = 5 [
    (gogoproto.jsontag) = "client_signature",
    (gogoproto.moretags) = "yaml:\"client_signature\""
  ];

  // UserSignature is the cryptographic signature from the user's account
  bytes user_signature = 6 [
    (gogoproto.jsontag) = "user_signature",
    (gogoproto.moretags) = "yaml:\"user_signature\""
  ];

  // PayloadHash is the SHA256 hash of the encrypted payload
  bytes payload_hash = 7 [
    (gogoproto.jsontag) = "payload_hash",
    (gogoproto.moretags) = "yaml:\"payload_hash\""
  ];

  // UploadNonce is a unique nonce for this upload session
  bytes upload_nonce = 8 [
    (gogoproto.jsontag) = "upload_nonce",
    (gogoproto.moretags) = "yaml:\"upload_nonce\""
  ];

  // CaptureTimestamp is when the data was captured (Unix timestamp)
  int64 capture_timestamp = 9 [
    (gogoproto.jsontag) = "capture_timestamp",
    (gogoproto.moretags) = "yaml:\"capture_timestamp\""
  ];

  // GeoHint is an optional geographic hint (coarse location)
  string geo_hint = 10 [
    (gogoproto.jsontag) = "geo_hint",
    (gogoproto.moretags) = "yaml:\"geo_hint\""
  ];
}

// ScopeRef is a lightweight reference to an identity scope
message ScopeRef {
  option (gogoproto.equal) = true;

  // ScopeID is the unique identifier for the scope
  string scope_id = 1 [
    (gogoproto.jsontag) = "scope_id",
    (gogoproto.moretags) = "yaml:\"scope_id\""
  ];

  // ScopeType indicates what kind of identity data this scope contains
  ScopeType scope_type = 2 [
    (gogoproto.jsontag) = "scope_type",
    (gogoproto.moretags) = "yaml:\"scope_type\""
  ];

  // Status is the current verification status
  VerificationStatus status = 3 [
    (gogoproto.jsontag) = "status",
    (gogoproto.moretags) = "yaml:\"status\""
  ];

  // UploadedAt is when the scope was uploaded (Unix timestamp)
  int64 uploaded_at = 4 [
    (gogoproto.jsontag) = "uploaded_at",
    (gogoproto.moretags) = "yaml:\"uploaded_at\""
  ];

  // VerifiedAt is when the scope was verified (Unix timestamp)
  int64 verified_at = 5 [
    (gogoproto.jsontag) = "verified_at",
    (gogoproto.moretags) = "yaml:\"verified_at\""
  ];

  // ExpiresAt is when the verification expires (Unix timestamp)
  int64 expires_at = 6 [
    (gogoproto.jsontag) = "expires_at",
    (gogoproto.moretags) = "yaml:\"expires_at\""
  ];
}

// IdentityScope represents a single piece of identity information
message IdentityScope {
  option (gogoproto.equal) = true;

  // ScopeID is the unique identifier for this scope
  string scope_id = 1 [
    (gogoproto.jsontag) = "scope_id",
    (gogoproto.moretags) = "yaml:\"scope_id\""
  ];

  // ScopeType indicates what kind of identity data this scope contains
  ScopeType scope_type = 2 [
    (gogoproto.jsontag) = "scope_type",
    (gogoproto.moretags) = "yaml:\"scope_type\""
  ];

  // Version is the schema version for this scope
  uint32 version = 3 [
    (gogoproto.jsontag) = "version",
    (gogoproto.moretags) = "yaml:\"version\""
  ];

  // EncryptedPayload contains the encrypted identity data
  EncryptedPayloadEnvelope encrypted_payload = 4 [
    (gogoproto.nullable) = false,
    (gogoproto.jsontag) = "encrypted_payload",
    (gogoproto.moretags) = "yaml:\"encrypted_payload\""
  ];

  // UploadMetadata contains metadata about the upload
  UploadMetadata upload_metadata = 5 [
    (gogoproto.nullable) = false,
    (gogoproto.jsontag) = "upload_metadata",
    (gogoproto.moretags) = "yaml:\"upload_metadata\""
  ];

  // Status is the current verification status
  VerificationStatus status = 6 [
    (gogoproto.jsontag) = "status",
    (gogoproto.moretags) = "yaml:\"status\""
  ];

  // UploadedAt is when this scope was uploaded (Unix timestamp)
  int64 uploaded_at = 7 [
    (gogoproto.jsontag) = "uploaded_at",
    (gogoproto.moretags) = "yaml:\"uploaded_at\""
  ];

  // VerifiedAt is when this scope was verified (Unix timestamp)
  int64 verified_at = 8 [
    (gogoproto.jsontag) = "verified_at",
    (gogoproto.moretags) = "yaml:\"verified_at\""
  ];

  // ExpiresAt is when the verification expires (Unix timestamp)
  int64 expires_at = 9 [
    (gogoproto.jsontag) = "expires_at",
    (gogoproto.moretags) = "yaml:\"expires_at\""
  ];

  // OwnerAddress is the blockchain address that owns this scope
  string owner_address = 10 [
    (cosmos_proto.scalar) = "cosmos.AddressString",
    (gogoproto.jsontag) = "owner_address",
    (gogoproto.moretags) = "yaml:\"owner_address\""
  ];
}

// IdentityRecord represents a user's complete identity record on-chain
message IdentityRecord {
  option (gogoproto.equal) = true;

  // AccountAddress is the blockchain address that owns this identity
  string account_address = 1 [
    (cosmos_proto.scalar) = "cosmos.AddressString",
    (gogoproto.jsontag) = "account_address",
    (gogoproto.moretags) = "yaml:\"account_address\""
  ];

  // ScopeRefs are lightweight references to the scopes owned by this identity
  repeated ScopeRef scope_refs = 2 [
    (gogoproto.nullable) = false,
    (gogoproto.jsontag) = "scope_refs",
    (gogoproto.moretags) = "yaml:\"scope_refs\""
  ];

  // CurrentScore is the current identity score (0-100)
  uint32 current_score = 3 [
    (gogoproto.jsontag) = "current_score",
    (gogoproto.moretags) = "yaml:\"current_score\""
  ];

  // ScoreVersion is the ML model version used to compute the current score
  string score_version = 4 [
    (gogoproto.jsontag) = "score_version",
    (gogoproto.moretags) = "yaml:\"score_version\""
  ];

  // LastVerifiedAt is when the identity was last verified (Unix timestamp)
  int64 last_verified_at = 5 [
    (gogoproto.jsontag) = "last_verified_at",
    (gogoproto.moretags) = "yaml:\"last_verified_at\""
  ];

  // CreatedAt is when this identity record was created (Unix timestamp)
  int64 created_at = 6 [
    (gogoproto.jsontag) = "created_at",
    (gogoproto.moretags) = "yaml:\"created_at\""
  ];

  // UpdatedAt is when this identity record was last updated (Unix timestamp)
  int64 updated_at = 7 [
    (gogoproto.jsontag) = "updated_at",
    (gogoproto.moretags) = "yaml:\"updated_at\""
  ];

  // Tier is the current identity tier based on score
  IdentityTier tier = 8 [
    (gogoproto.jsontag) = "tier",
    (gogoproto.moretags) = "yaml:\"tier\""
  ];

  // Flags contains any flags on this identity
  repeated string flags = 9 [
    (gogoproto.jsontag) = "flags",
    (gogoproto.moretags) = "yaml:\"flags\""
  ];

  // Locked indicates if the identity is locked
  bool locked = 10 [
    (gogoproto.jsontag) = "locked",
    (gogoproto.moretags) = "yaml:\"locked\""
  ];

  // LockedReason is the reason for locking
  string locked_reason = 11 [
    (gogoproto.jsontag) = "locked_reason",
    (gogoproto.moretags) = "yaml:\"locked_reason\""
  ];
}

// IdentityScore represents the current identity score for an account
message IdentityScore {
  option (gogoproto.equal) = true;

  // AccountAddress is the blockchain address this score belongs to
  string account_address = 1 [
    (cosmos_proto.scalar) = "cosmos.AddressString",
    (gogoproto.jsontag) = "account_address",
    (gogoproto.moretags) = "yaml:\"account_address\""
  ];

  // Score is the current identity score (0-100)
  uint32 score = 2 [
    (gogoproto.jsontag) = "score",
    (gogoproto.moretags) = "yaml:\"score\""
  ];

  // Status is the current account verification status
  AccountStatus status = 3 [
    (gogoproto.jsontag) = "status",
    (gogoproto.moretags) = "yaml:\"status\""
  ];

  // Tier is the identity tier based on score
  IdentityTier tier = 4 [
    (gogoproto.jsontag) = "tier",
    (gogoproto.moretags) = "yaml:\"tier\""
  ];

  // ModelVersion is the ML model version used
  string model_version = 5 [
    (gogoproto.jsontag) = "model_version",
    (gogoproto.moretags) = "yaml:\"model_version\""
  ];

  // LastUpdatedAt is when the score was last updated (Unix timestamp)
  int64 last_updated_at = 6 [
    (gogoproto.jsontag) = "last_updated_at",
    (gogoproto.moretags) = "yaml:\"last_updated_at\""
  ];

  // BlockHeight is the block height when score was computed
  int64 block_height = 7 [
    (gogoproto.jsontag) = "block_height",
    (gogoproto.moretags) = "yaml:\"block_height\""
  ];
}

// ConsentSettings represents consent configuration for an identity wallet
message ConsentSettings {
  option (gogoproto.equal) = true;

  // ShareWithProviders allows providers to access non-sensitive identity metadata
  bool share_with_providers = 1 [
    (gogoproto.jsontag) = "share_with_providers",
    (gogoproto.moretags) = "yaml:\"share_with_providers\""
  ];

  // ShareForVerification allows the identity to be used for verification requests
  bool share_for_verification = 2 [
    (gogoproto.jsontag) = "share_for_verification",
    (gogoproto.moretags) = "yaml:\"share_for_verification\""
  ];

  // AllowReVerification allows the identity to be re-verified without explicit request
  bool allow_re_verification = 3 [
    (gogoproto.jsontag) = "allow_re_verification",
    (gogoproto.moretags) = "yaml:\"allow_re_verification\""
  ];

  // AllowDerivedFeatureSharing allows sharing of derived feature hashes
  bool allow_derived_feature_sharing = 4 [
    (gogoproto.jsontag) = "allow_derived_feature_sharing",
    (gogoproto.moretags) = "yaml:\"allow_derived_feature_sharing\""
  ];

  // ConsentVersion tracks consent settings version for audit
  uint32 consent_version = 5 [
    (gogoproto.jsontag) = "consent_version",
    (gogoproto.moretags) = "yaml:\"consent_version\""
  ];

  // LastUpdatedAt is when consent was last updated (Unix timestamp)
  int64 last_updated_at = 6 [
    (gogoproto.jsontag) = "last_updated_at",
    (gogoproto.moretags) = "yaml:\"last_updated_at\""
  ];
}

// GlobalConsentUpdate represents an update to global consent settings
message GlobalConsentUpdate {
  option (gogoproto.equal) = true;

  // ShareWithProviders update
  bool share_with_providers = 1;
  
  // ShareForVerification update
  bool share_for_verification = 2;
  
  // AllowReVerification update
  bool allow_re_verification = 3;
  
  // AllowDerivedFeatureSharing update
  bool allow_derived_feature_sharing = 4;
}

// BorderlineParams contains parameters for borderline score handling
message BorderlineParams {
  option (gogoproto.equal) = true;

  // LowerThreshold is the lower threshold for borderline scores
  uint32 lower_threshold = 1 [
    (gogoproto.jsontag) = "lower_threshold",
    (gogoproto.moretags) = "yaml:\"lower_threshold\""
  ];

  // UpperThreshold is the upper threshold for borderline scores
  uint32 upper_threshold = 2 [
    (gogoproto.jsontag) = "upper_threshold",
    (gogoproto.moretags) = "yaml:\"upper_threshold\""
  ];

  // MfaTimeoutBlocks is how long MFA challenge is valid
  int64 mfa_timeout_blocks = 3 [
    (gogoproto.jsontag) = "mfa_timeout_blocks",
    (gogoproto.moretags) = "yaml:\"mfa_timeout_blocks\""
  ];

  // RequiredFactors is the number of MFA factors required
  uint32 required_factors = 4 [
    (gogoproto.jsontag) = "required_factors",
    (gogoproto.moretags) = "yaml:\"required_factors\""
  ];
}

// ApprovedClient represents an approved client application
message ApprovedClient {
  option (gogoproto.equal) = true;

  // ClientID is the unique identifier for the client
  string client_id = 1 [
    (gogoproto.jsontag) = "client_id",
    (gogoproto.moretags) = "yaml:\"client_id\""
  ];

  // Name is the human-readable name of the client
  string name = 2 [
    (gogoproto.jsontag) = "name",
    (gogoproto.moretags) = "yaml:\"name\""
  ];

  // PublicKey is the client's public key for signature verification
  bytes public_key = 3 [
    (gogoproto.jsontag) = "public_key",
    (gogoproto.moretags) = "yaml:\"public_key\""
  ];

  // Active indicates if the client is currently active
  bool active = 4 [
    (gogoproto.jsontag) = "active",
    (gogoproto.moretags) = "yaml:\"active\""
  ];

  // CreatedAt is when the client was registered (Unix timestamp)
  int64 created_at = 5 [
    (gogoproto.jsontag) = "created_at",
    (gogoproto.moretags) = "yaml:\"created_at\""
  ];

  // DeactivatedAt is when the client was deactivated (Unix timestamp)
  int64 deactivated_at = 6 [
    (gogoproto.jsontag) = "deactivated_at",
    (gogoproto.moretags) = "yaml:\"deactivated_at\""
  ];
}

// Params defines the parameters for the veid module
message Params {
  option (gogoproto.goproto_stringer) = false;
  option (gogoproto.equal) = true;
  option (amino.name) = "virtengine/x/veid/Params";

  // MaxScopesPerAccount is the maximum number of scopes per account
  uint32 max_scopes_per_account = 1 [
    (gogoproto.jsontag) = "max_scopes_per_account",
    (gogoproto.moretags) = "yaml:\"max_scopes_per_account\""
  ];

  // MaxScopesPerType is the maximum number of scopes per type per account
  uint32 max_scopes_per_type = 2 [
    (gogoproto.jsontag) = "max_scopes_per_type",
    (gogoproto.moretags) = "yaml:\"max_scopes_per_type\""
  ];

  // SaltMinBytes is the minimum salt size in bytes
  uint32 salt_min_bytes = 3 [
    (gogoproto.jsontag) = "salt_min_bytes",
    (gogoproto.moretags) = "yaml:\"salt_min_bytes\""
  ];

  // SaltMaxBytes is the maximum salt size in bytes
  uint32 salt_max_bytes = 4 [
    (gogoproto.jsontag) = "salt_max_bytes",
    (gogoproto.moretags) = "yaml:\"salt_max_bytes\""
  ];

  // RequireClientSignature determines if client signatures are mandatory
  bool require_client_signature = 5 [
    (gogoproto.jsontag) = "require_client_signature",
    (gogoproto.moretags) = "yaml:\"require_client_signature\""
  ];

  // RequireUserSignature determines if user signatures are mandatory
  bool require_user_signature = 6 [
    (gogoproto.jsontag) = "require_user_signature",
    (gogoproto.moretags) = "yaml:\"require_user_signature\""
  ];

  // VerificationExpiryDays is how long a verification is valid (in days)
  uint32 verification_expiry_days = 7 [
    (gogoproto.jsontag) = "verification_expiry_days",
    (gogoproto.moretags) = "yaml:\"verification_expiry_days\""
  ];
}

// ============================================================================
// Additional State Types (VE-2000-B)
// ============================================================================

// DerivedFeatures contains hashes of derived features from identity scopes.
// These are used for verification matching without revealing the underlying data.
// All hashes are SHA-256 (32 bytes) for consistency.
message DerivedFeatures {
  option (gogoproto.equal) = true;

  // FaceEmbeddingHash is the SHA-256 hash of the face embedding vector.
  // The actual embedding is stored encrypted; this hash allows matching.
  bytes face_embedding_hash = 1 [
    (gogoproto.jsontag) = "face_embedding_hash",
    (gogoproto.moretags) = "yaml:\"face_embedding_hash\""
  ];

  // DocFieldHashes contains hashes of extracted document fields.
  // Keys are field names: "name_hash", "dob_hash", "doc_number_hash", etc.
  map<string, bytes> doc_field_hashes = 2 [
    (gogoproto.jsontag) = "doc_field_hashes",
    (gogoproto.moretags) = "yaml:\"doc_field_hashes\""
  ];

  // BiometricHash is the hash of biometric data (fingerprint, voice, etc.)
  bytes biometric_hash = 3 [
    (gogoproto.jsontag) = "biometric_hash",
    (gogoproto.moretags) = "yaml:\"biometric_hash\""
  ];

  // LivenessProofHash is the hash of liveness detection proof
  bytes liveness_proof_hash = 4 [
    (gogoproto.jsontag) = "liveness_proof_hash",
    (gogoproto.moretags) = "yaml:\"liveness_proof_hash\""
  ];

  // LastComputedAt is when these features were last computed (Unix timestamp)
  int64 last_computed_at = 5 [
    (gogoproto.jsontag) = "last_computed_at",
    (gogoproto.moretags) = "yaml:\"last_computed_at\""
  ];

  // ModelVersion is the ML model version used to compute these features
  string model_version = 6 [
    (gogoproto.jsontag) = "model_version",
    (gogoproto.moretags) = "yaml:\"model_version\""
  ];

  // ComputedBy is the validator address that computed these features
  string computed_by = 7 [
    (cosmos_proto.scalar) = "cosmos.AddressString",
    (gogoproto.jsontag) = "computed_by",
    (gogoproto.moretags) = "yaml:\"computed_by\""
  ];

  // BlockHeight is the block height when features were computed
  int64 block_height = 8 [
    (gogoproto.jsontag) = "block_height",
    (gogoproto.moretags) = "yaml:\"block_height\""
  ];

  // FeatureVersion tracks the derived features schema version
  uint32 feature_version = 9 [
    (gogoproto.jsontag) = "feature_version",
    (gogoproto.moretags) = "yaml:\"feature_version\""
  ];
}

// ScopeReference represents a reference to an encrypted scope within a wallet.
// This is a more detailed reference than ScopeRef, containing wallet-specific metadata.
message ScopeReference {
  option (gogoproto.equal) = true;

  // ScopeID is the unique identifier of the scope
  string scope_id = 1 [
    (gogoproto.jsontag) = "scope_id",
    (gogoproto.moretags) = "yaml:\"scope_id\""
  ];

  // ScopeType indicates what kind of identity data this scope contains
  ScopeType scope_type = 2 [
    (gogoproto.jsontag) = "scope_type",
    (gogoproto.moretags) = "yaml:\"scope_type\""
  ];

  // EnvelopeHash is the SHA-256 hash of the encrypted envelope.
  // This allows verification without exposing the encrypted content.
  bytes envelope_hash = 3 [
    (gogoproto.jsontag) = "envelope_hash",
    (gogoproto.moretags) = "yaml:\"envelope_hash\""
  ];

  // AddedAt is when this scope was added to the wallet (Unix timestamp)
  int64 added_at = 4 [
    (gogoproto.jsontag) = "added_at",
    (gogoproto.moretags) = "yaml:\"added_at\""
  ];

  // Status is the current status of this scope reference
  ScopeRefStatus status = 5 [
    (gogoproto.jsontag) = "status",
    (gogoproto.moretags) = "yaml:\"status\""
  ];

  // ConsentGranted indicates if consent has been granted for this scope
  bool consent_granted = 6 [
    (gogoproto.jsontag) = "consent_granted",
    (gogoproto.moretags) = "yaml:\"consent_granted\""
  ];

  // RevocationReason is the reason for revocation (if revoked)
  string revocation_reason = 7 [
    (gogoproto.jsontag) = "revocation_reason",
    (gogoproto.moretags) = "yaml:\"revocation_reason\""
  ];

  // RevokedAt is when this scope was revoked (Unix timestamp, 0 if not revoked)
  int64 revoked_at = 8 [
    (gogoproto.jsontag) = "revoked_at",
    (gogoproto.moretags) = "yaml:\"revoked_at\""
  ];

  // ExpiresAt is when this scope reference expires (Unix timestamp, 0 for no expiry)
  int64 expires_at = 9 [
    (gogoproto.jsontag) = "expires_at",
    (gogoproto.moretags) = "yaml:\"expires_at\""
  ];
}

// ScopeConsent represents consent configuration for a specific scope.
// This tracks per-scope consent settings within a wallet.
message ScopeConsent {
  option (gogoproto.equal) = true;

  // ScopeID is the identifier of the scope this consent applies to
  string scope_id = 1 [
    (gogoproto.jsontag) = "scope_id",
    (gogoproto.moretags) = "yaml:\"scope_id\""
  ];

  // Granted indicates if consent is currently granted
  bool granted = 2 [
    (gogoproto.jsontag) = "granted",
    (gogoproto.moretags) = "yaml:\"granted\""
  ];

  // GrantedAt is when consent was granted (Unix timestamp, 0 if never granted)
  int64 granted_at = 3 [
    (gogoproto.jsontag) = "granted_at",
    (gogoproto.moretags) = "yaml:\"granted_at\""
  ];

  // RevokedAt is when consent was revoked (Unix timestamp, 0 if not revoked)
  int64 revoked_at = 4 [
    (gogoproto.jsontag) = "revoked_at",
    (gogoproto.moretags) = "yaml:\"revoked_at\""
  ];

  // ExpiresAt is when this consent expires (Unix timestamp, 0 for no expiration)
  int64 expires_at = 5 [
    (gogoproto.jsontag) = "expires_at",
    (gogoproto.moretags) = "yaml:\"expires_at\""
  ];

  // Purpose describes the purpose for which consent was granted
  string purpose = 6 [
    (gogoproto.jsontag) = "purpose",
    (gogoproto.moretags) = "yaml:\"purpose\""
  ];

  // GrantedToProviders lists specific providers consent was granted to.
  // Empty means consent is general (not provider-specific).
  repeated string granted_to_providers = 7 [
    (gogoproto.jsontag) = "granted_to_providers",
    (gogoproto.moretags) = "yaml:\"granted_to_providers\""
  ];

  // Restrictions contains any restrictions on this consent
  repeated string restrictions = 8 [
    (gogoproto.jsontag) = "restrictions",
    (gogoproto.moretags) = "yaml:\"restrictions\""
  ];
}

// VerificationHistoryEntry represents a single verification event in the wallet's history.
// This tracks score and status changes over time for audit purposes.
message VerificationHistoryEntry {
  option (gogoproto.equal) = true;

  // EntryID is a unique identifier for this history entry
  string entry_id = 1 [
    (gogoproto.jsontag) = "entry_id",
    (gogoproto.moretags) = "yaml:\"entry_id\""
  ];

  // Timestamp is when this verification occurred (Unix timestamp)
  int64 timestamp = 2 [
    (gogoproto.jsontag) = "timestamp",
    (gogoproto.moretags) = "yaml:\"timestamp\""
  ];

  // BlockHeight is the block height when this was recorded
  int64 block_height = 3 [
    (gogoproto.jsontag) = "block_height",
    (gogoproto.moretags) = "yaml:\"block_height\""
  ];

  // PreviousScore is the score before this verification
  uint32 previous_score = 4 [
    (gogoproto.jsontag) = "previous_score",
    (gogoproto.moretags) = "yaml:\"previous_score\""
  ];

  // NewScore is the score after this verification
  uint32 new_score = 5 [
    (gogoproto.jsontag) = "new_score",
    (gogoproto.moretags) = "yaml:\"new_score\""
  ];

  // PreviousStatus is the status before this verification
  AccountStatus previous_status = 6 [
    (gogoproto.jsontag) = "previous_status",
    (gogoproto.moretags) = "yaml:\"previous_status\""
  ];

  // NewStatus is the status after this verification
  AccountStatus new_status = 7 [
    (gogoproto.jsontag) = "new_status",
    (gogoproto.moretags) = "yaml:\"new_status\""
  ];

  // ScopesEvaluated lists the scope IDs that were evaluated
  repeated string scopes_evaluated = 8 [
    (gogoproto.jsontag) = "scopes_evaluated",
    (gogoproto.moretags) = "yaml:\"scopes_evaluated\""
  ];

  // ModelVersion is the ML model version used for this verification
  string model_version = 9 [
    (gogoproto.jsontag) = "model_version",
    (gogoproto.moretags) = "yaml:\"model_version\""
  ];

  // ValidatorAddress is the address of the validator that performed this verification
  string validator_address = 10 [
    (cosmos_proto.scalar) = "cosmos.AddressString",
    (gogoproto.jsontag) = "validator_address",
    (gogoproto.moretags) = "yaml:\"validator_address\""
  ];

  // Reason is an optional reason/description for this verification
  string reason = 11 [
    (gogoproto.jsontag) = "reason",
    (gogoproto.moretags) = "yaml:\"reason\""
  ];
}

// IdentityWallet represents a user-controlled identity container.
// This is the first-class on-chain identity primitive that references
// encrypted scopes and derived features, bound to the user's account key(s).
message IdentityWallet {
  option (gogoproto.equal) = true;

  // WalletID is the unique identifier for this wallet.
  // Typically derived from the account address.
  string wallet_id = 1 [
    (gogoproto.jsontag) = "wallet_id",
    (gogoproto.moretags) = "yaml:\"wallet_id\""
  ];

  // AccountAddress is the blockchain address bound to this wallet
  string account_address = 2 [
    (cosmos_proto.scalar) = "cosmos.AddressString",
    (gogoproto.jsontag) = "account_address",
    (gogoproto.moretags) = "yaml:\"account_address\""
  ];

  // CreatedAt is when this wallet was created (Unix timestamp)
  int64 created_at = 3 [
    (gogoproto.jsontag) = "created_at",
    (gogoproto.moretags) = "yaml:\"created_at\""
  ];

  // UpdatedAt is when this wallet was last updated (Unix timestamp)
  int64 updated_at = 4 [
    (gogoproto.jsontag) = "updated_at",
    (gogoproto.moretags) = "yaml:\"updated_at\""
  ];

  // Status is the current status of the wallet
  WalletStatus status = 5 [
    (gogoproto.jsontag) = "status",
    (gogoproto.moretags) = "yaml:\"status\""
  ];

  // ScopeRefs are references to encrypted scope envelopes.
  // These are opaque references - the actual encrypted data is stored separately.
  repeated ScopeReference scope_refs = 6 [
    (gogoproto.nullable) = false,
    (gogoproto.jsontag) = "scope_refs",
    (gogoproto.moretags) = "yaml:\"scope_refs\""
  ];

  // DerivedFeatures contains hashes of derived features for verification matching
  DerivedFeatures derived_features = 7 [
    (gogoproto.nullable) = false,
    (gogoproto.jsontag) = "derived_features",
    (gogoproto.moretags) = "yaml:\"derived_features\""
  ];

  // CurrentScore is the current identity verification score (0-100)
  uint32 current_score = 8 [
    (gogoproto.jsontag) = "current_score",
    (gogoproto.moretags) = "yaml:\"current_score\""
  ];

  // ScoreStatus is the current verification status
  AccountStatus score_status = 9 [
    (gogoproto.jsontag) = "score_status",
    (gogoproto.moretags) = "yaml:\"score_status\""
  ];

  // VerificationHistory contains the history of verification events
  repeated VerificationHistoryEntry verification_history = 10 [
    (gogoproto.nullable) = false,
    (gogoproto.jsontag) = "verification_history",
    (gogoproto.moretags) = "yaml:\"verification_history\""
  ];

  // ConsentSettings contains the consent configuration for this wallet
  ConsentSettings consent_settings = 11 [
    (gogoproto.nullable) = false,
    (gogoproto.jsontag) = "consent_settings",
    (gogoproto.moretags) = "yaml:\"consent_settings\""
  ];

  // ScopeConsents contains per-scope consent settings (key is scopeID)
  map<string, ScopeConsent> scope_consents = 12 [
    (gogoproto.jsontag) = "scope_consents",
    (gogoproto.moretags) = "yaml:\"scope_consents\""
  ];

  // BindingSignature is the user's signature over (WalletID + AccountAddress).
  // This cryptographically binds the wallet to the user's account.
  bytes binding_signature = 13 [
    (gogoproto.jsontag) = "binding_signature",
    (gogoproto.moretags) = "yaml:\"binding_signature\""
  ];

  // BindingPubKey is the public key used to create the binding signature.
  // This is captured at wallet creation and updated on key rotation.
  bytes binding_pub_key = 14 [
    (gogoproto.jsontag) = "binding_pub_key",
    (gogoproto.moretags) = "yaml:\"binding_pub_key\""
  ];

  // LastBindingAt is when the wallet was last bound/rebound (Unix timestamp)
  int64 last_binding_at = 15 [
    (gogoproto.jsontag) = "last_binding_at",
    (gogoproto.moretags) = "yaml:\"last_binding_at\""
  ];

  // Tier is the current identity tier based on score
  IdentityTier tier = 16 [
    (gogoproto.jsontag) = "tier",
    (gogoproto.moretags) = "yaml:\"tier\""
  ];

  // Metadata contains additional wallet metadata
  map<string, string> metadata = 17 [
    (gogoproto.jsontag) = "metadata",
    (gogoproto.moretags) = "yaml:\"metadata\""
  ];
}

// ======================================================================
// Web-Scope Verification Types (SSO/Email/SMS)
// ======================================================================

// SSOLinkageMetadata represents on-chain metadata for SSO linkage.
message SSOLinkageMetadata {
  uint32 version = 1 [(gogoproto.jsontag) = "version"];
  string linkage_id = 2 [(gogoproto.jsontag) = "linkage_id"];
  string provider = 3 [(gogoproto.jsontag) = "provider"];
  string issuer = 4 [(gogoproto.jsontag) = "issuer"];
  string subject_hash = 5 [(gogoproto.jsontag) = "subject_hash"];
  string nonce = 6 [(gogoproto.jsontag) = "nonce"];
  int64 verified_at = 7 [(gogoproto.jsontag) = "verified_at"];
  int64 expires_at = 8 [(gogoproto.jsontag) = "expires_at"];
  bytes account_signature = 9 [(gogoproto.jsontag) = "account_signature"];
  string status = 10 [(gogoproto.jsontag) = "status"];
  string email_domain_hash = 11 [(gogoproto.jsontag) = "email_domain_hash"];
  string org_id_hash = 12 [(gogoproto.jsontag) = "org_id_hash"];
  string evidence_hash = 13 [(gogoproto.jsontag) = "evidence_hash"];
  string evidence_storage_backend = 14 [(gogoproto.jsontag) = "evidence_storage_backend"];
  string evidence_storage_ref = 15 [(gogoproto.jsontag) = "evidence_storage_ref"];
  map<string, string> evidence_metadata = 16 [
    (gogoproto.jsontag) = "evidence_metadata",
    (gogoproto.moretags) = "yaml:\"evidence_metadata\""
  ];
}

// PhoneNumberHash represents a hashed phone number with salt.
message PhoneNumberHash {
  string hash = 1 [(gogoproto.jsontag) = "hash"];
  string salt = 2 [(gogoproto.jsontag) = "salt"];
  string country_code_hash = 3 [(gogoproto.jsontag) = "country_code_hash"];
  int64 created_at = 4 [(gogoproto.jsontag) = "created_at"];
}

// EmailVerificationRecord represents on-chain email verification metadata.
message EmailVerificationRecord {
  uint32 version = 1 [(gogoproto.jsontag) = "version"];
  string verification_id = 2 [(gogoproto.jsontag) = "verification_id"];
  string account_address = 3 [(cosmos_proto.scalar) = "cosmos.AddressString", (gogoproto.jsontag) = "account_address"];
  string email_hash = 4 [(gogoproto.jsontag) = "email_hash"];
  string domain_hash = 5 [(gogoproto.jsontag) = "domain_hash"];
  string nonce = 6 [(gogoproto.jsontag) = "nonce"];
  int64 nonce_used_at = 7 [(gogoproto.jsontag) = "nonce_used_at"];
  string status = 8 [(gogoproto.jsontag) = "status"];
  int64 verified_at = 9 [(gogoproto.jsontag) = "verified_at"];
  int64 expires_at = 10 [(gogoproto.jsontag) = "expires_at"];
  int64 created_at = 11 [(gogoproto.jsontag) = "created_at"];
  int64 updated_at = 12 [(gogoproto.jsontag) = "updated_at"];
  bytes account_signature = 13 [(gogoproto.jsontag) = "account_signature"];
  bool is_organizational = 14 [(gogoproto.jsontag) = "is_organizational"];
  uint32 verification_attempts = 15 [(gogoproto.jsontag) = "verification_attempts"];
  string evidence_hash = 16 [(gogoproto.jsontag) = "evidence_hash"];
  string evidence_storage_backend = 17 [(gogoproto.jsontag) = "evidence_storage_backend"];
  string evidence_storage_ref = 18 [(gogoproto.jsontag) = "evidence_storage_ref"];
  map<string, string> evidence_metadata = 19 [
    (gogoproto.jsontag) = "evidence_metadata",
    (gogoproto.moretags) = "yaml:\"evidence_metadata\""
  ];
}

// SMSVerificationRecord represents on-chain SMS verification metadata.
message SMSVerificationRecord {
  uint32 version = 1 [(gogoproto.jsontag) = "version"];
  string verification_id = 2 [(gogoproto.jsontag) = "verification_id"];
  string account_address = 3 [(cosmos_proto.scalar) = "cosmos.AddressString", (gogoproto.jsontag) = "account_address"];
  PhoneNumberHash phone_hash = 4 [(gogoproto.jsontag) = "phone_hash"];
  string status = 5 [(gogoproto.jsontag) = "status"];
  int64 verified_at = 6 [(gogoproto.jsontag) = "verified_at"];
  int64 expires_at = 7 [(gogoproto.jsontag) = "expires_at"];
  int64 created_at = 8 [(gogoproto.jsontag) = "created_at"];
  int64 updated_at = 9 [(gogoproto.jsontag) = "updated_at"];
  uint32 verification_attempts = 10 [(gogoproto.jsontag) = "verification_attempts"];
  bool is_voip = 11 [(gogoproto.jsontag) = "is_voip"];
  string carrier_type = 12 [(gogoproto.jsontag) = "carrier_type"];
  string validator_address = 13 [(gogoproto.jsontag) = "validator_address"];
  bytes account_signature = 14 [(gogoproto.jsontag) = "account_signature"];
  string evidence_hash = 15 [(gogoproto.jsontag) = "evidence_hash"];
  string evidence_storage_backend = 16 [(gogoproto.jsontag) = "evidence_storage_backend"];
  string evidence_storage_ref = 17 [(gogoproto.jsontag) = "evidence_storage_ref"];
  map<string, string> evidence_metadata = 18 [
    (gogoproto.jsontag) = "evidence_metadata",
    (gogoproto.moretags) = "yaml:\"evidence_metadata\""
  ];
}

// SocialMediaScope represents on-chain social media profile metadata.
// Only hashed PII is stored; full payloads are encrypted.
message SocialMediaScope {
  uint32 version = 1 [(gogoproto.jsontag) = "version"];
  string scope_id = 2 [(gogoproto.jsontag) = "scope_id"];
  string account_address = 3 [(cosmos_proto.scalar) = "cosmos.AddressString", (gogoproto.jsontag) = "account_address"];
  SocialMediaProvider provider = 4 [(gogoproto.jsontag) = "provider"];
  string profile_name_hash = 5 [(gogoproto.jsontag) = "profile_name_hash"];
  string email_hash = 6 [(gogoproto.jsontag) = "email_hash"];
  string username_hash = 7 [(gogoproto.jsontag) = "username_hash"];
  string org_hash = 8 [(gogoproto.jsontag) = "org_hash"];
  int64 account_created_at = 9 [(gogoproto.jsontag) = "account_created_at"];
  uint32 account_age_days = 10 [(gogoproto.jsontag) = "account_age_days"];
  bool is_verified = 11 [(gogoproto.jsontag) = "is_verified"];
  string friend_count_range = 12 [(gogoproto.jsontag) = "friend_count_range"];
  string status = 13 [(gogoproto.jsontag) = "status"];
  int64 created_at = 14 [(gogoproto.jsontag) = "created_at"];
  int64 updated_at = 15 [(gogoproto.jsontag) = "updated_at"];
  EncryptedPayloadEnvelope encrypted_payload = 16 [
    (gogoproto.nullable) = false,
    (gogoproto.jsontag) = "encrypted_payload",
    (gogoproto.moretags) = "yaml:\"encrypted_payload\""
  ];
  string evidence_hash = 17 [(gogoproto.jsontag) = "evidence_hash"];
  string evidence_storage_backend = 18 [(gogoproto.jsontag) = "evidence_storage_backend"];
  string evidence_storage_ref = 19 [(gogoproto.jsontag) = "evidence_storage_ref"];
  map<string, string> evidence_metadata = 20 [
    (gogoproto.jsontag) = "evidence_metadata",
    (gogoproto.moretags) = "yaml:\"evidence_metadata\""
  ];
}
