syntax = "proto3";
package virtengine.hpc.v1;

import "gogoproto/gogo.proto";
import "google/api/annotations.proto";
import "cosmos_proto/cosmos.proto";
import "cosmos/base/query/v1beta1/pagination.proto";
import "virtengine/hpc/v1/types.proto";

option go_package = "github.com/virtengine/virtengine/sdk/go/node/hpc/v1";

// Query defines the gRPC querier service for the hpc module
service Query {
  // Cluster returns a cluster by ID
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc Cluster(QueryClusterRequest) returns (QueryClusterResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/cluster/{cluster_id}";
  }

  // Clusters returns all clusters with optional filters
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc Clusters(QueryClustersRequest) returns (QueryClustersResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/clusters";
  }

  // ClustersByProvider returns clusters owned by a provider
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc ClustersByProvider(QueryClustersByProviderRequest) returns (QueryClustersByProviderResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/clusters/provider/{provider_address}";
  }

  // Offering returns an offering by ID
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc Offering(QueryOfferingRequest) returns (QueryOfferingResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/offering/{offering_id}";
  }

  // Offerings returns all offerings with optional filters
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc Offerings(QueryOfferingsRequest) returns (QueryOfferingsResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/offerings";
  }

  // OfferingsByCluster returns offerings for a cluster
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc OfferingsByCluster(QueryOfferingsByClusterRequest) returns (QueryOfferingsByClusterResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/offerings/cluster/{cluster_id}";
  }

  // Job returns a job by ID
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc Job(QueryJobRequest) returns (QueryJobResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/job/{job_id}";
  }

  // Jobs returns all jobs with optional filters
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc Jobs(QueryJobsRequest) returns (QueryJobsResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/jobs";
  }

  // JobsByCustomer returns jobs submitted by a customer
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc JobsByCustomer(QueryJobsByCustomerRequest) returns (QueryJobsByCustomerResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/jobs/customer/{customer_address}";
  }

  // JobsByProvider returns jobs handled by a provider
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc JobsByProvider(QueryJobsByProviderRequest) returns (QueryJobsByProviderResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/jobs/provider/{provider_address}";
  }

  // JobAccounting returns accounting data for a job
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc JobAccounting(QueryJobAccountingRequest) returns (QueryJobAccountingResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/job/{job_id}/accounting";
  }

  // NodeMetadata returns metadata for a node
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc NodeMetadata(QueryNodeMetadataRequest) returns (QueryNodeMetadataResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/node/{node_id}";
  }

  // NodesByCluster returns nodes in a cluster
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc NodesByCluster(QueryNodesByClusterRequest) returns (QueryNodesByClusterResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/nodes/cluster/{cluster_id}";
  }

  // SchedulingDecision returns a scheduling decision by ID
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc SchedulingDecision(QuerySchedulingDecisionRequest) returns (QuerySchedulingDecisionResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/scheduling/{decision_id}";
  }

  // SchedulingDecisionByJob returns the scheduling decision for a job
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc SchedulingDecisionByJob(QuerySchedulingDecisionByJobRequest) returns (QuerySchedulingDecisionByJobResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/job/{job_id}/scheduling";
  }

  // Reward returns a reward record by ID
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc Reward(QueryRewardRequest) returns (QueryRewardResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/reward/{reward_id}";
  }

  // RewardsByJob returns rewards for a job
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc RewardsByJob(QueryRewardsByJobRequest) returns (QueryRewardsByJobResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/job/{job_id}/rewards";
  }

  // Dispute returns a dispute by ID
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc Dispute(QueryDisputeRequest) returns (QueryDisputeResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/dispute/{dispute_id}";
  }

  // Disputes returns all disputes with optional filters
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc Disputes(QueryDisputesRequest) returns (QueryDisputesResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/disputes";
  }

  // Params returns the module parameters
  // buf:lint:ignore RPC_REQUEST_RESPONSE_UNIQUE
  // buf:lint:ignore RPC_RESPONSE_STANDARD_NAME
  rpc Params(QueryParamsRequest) returns (QueryParamsResponse) {
    option (google.api.http).get = "/virtengine/hpc/v1/params";
  }
}

// QueryClusterRequest is the request for Query/Cluster
message QueryClusterRequest {
  string cluster_id = 1 [(gogoproto.jsontag) = "cluster_id", (gogoproto.moretags) = "yaml:\"cluster_id\""];
}

// QueryClusterResponse is the response for Query/Cluster
message QueryClusterResponse {
  HPCCluster cluster = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "cluster", (gogoproto.moretags) = "yaml:\"cluster\""];
}

// QueryClustersRequest is the request for Query/Clusters
message QueryClustersRequest {
  ClusterState state = 1 [(gogoproto.jsontag) = "state,omitempty", (gogoproto.moretags) = "yaml:\"state\""];
  string region = 2 [(gogoproto.jsontag) = "region,omitempty", (gogoproto.moretags) = "yaml:\"region\""];
  cosmos.base.query.v1beta1.PageRequest pagination = 3 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryClustersResponse is the response for Query/Clusters
message QueryClustersResponse {
  repeated HPCCluster clusters = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "clusters", (gogoproto.moretags) = "yaml:\"clusters\""];
  cosmos.base.query.v1beta1.PageResponse pagination = 2 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryClustersByProviderRequest is the request for Query/ClustersByProvider
message QueryClustersByProviderRequest {
  string provider_address = 1 [(cosmos_proto.scalar) = "cosmos.AddressString", (gogoproto.jsontag) = "provider_address", (gogoproto.moretags) = "yaml:\"provider_address\""];
  cosmos.base.query.v1beta1.PageRequest pagination = 2 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryClustersByProviderResponse is the response for Query/ClustersByProvider
message QueryClustersByProviderResponse {
  repeated HPCCluster clusters = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "clusters", (gogoproto.moretags) = "yaml:\"clusters\""];
  cosmos.base.query.v1beta1.PageResponse pagination = 2 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryOfferingRequest is the request for Query/Offering
message QueryOfferingRequest {
  string offering_id = 1 [(gogoproto.jsontag) = "offering_id", (gogoproto.moretags) = "yaml:\"offering_id\""];
}

// QueryOfferingResponse is the response for Query/Offering
message QueryOfferingResponse {
  HPCOffering offering = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "offering", (gogoproto.moretags) = "yaml:\"offering\""];
}

// QueryOfferingsRequest is the request for Query/Offerings
message QueryOfferingsRequest {
  bool active_only = 1 [(gogoproto.jsontag) = "active_only,omitempty", (gogoproto.moretags) = "yaml:\"active_only\""];
  cosmos.base.query.v1beta1.PageRequest pagination = 2 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryOfferingsResponse is the response for Query/Offerings
message QueryOfferingsResponse {
  repeated HPCOffering offerings = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "offerings", (gogoproto.moretags) = "yaml:\"offerings\""];
  cosmos.base.query.v1beta1.PageResponse pagination = 2 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryOfferingsByClusterRequest is the request for Query/OfferingsByCluster
message QueryOfferingsByClusterRequest {
  string cluster_id = 1 [(gogoproto.jsontag) = "cluster_id", (gogoproto.moretags) = "yaml:\"cluster_id\""];
  cosmos.base.query.v1beta1.PageRequest pagination = 2 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryOfferingsByClusterResponse is the response for Query/OfferingsByCluster
message QueryOfferingsByClusterResponse {
  repeated HPCOffering offerings = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "offerings", (gogoproto.moretags) = "yaml:\"offerings\""];
  cosmos.base.query.v1beta1.PageResponse pagination = 2 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryJobRequest is the request for Query/Job
message QueryJobRequest {
  string job_id = 1 [(gogoproto.jsontag) = "job_id", (gogoproto.moretags) = "yaml:\"job_id\""];
}

// QueryJobResponse is the response for Query/Job
message QueryJobResponse {
  HPCJob job = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "job", (gogoproto.moretags) = "yaml:\"job\""];
}

// QueryJobsRequest is the request for Query/Jobs
message QueryJobsRequest {
  JobState state = 1 [(gogoproto.jsontag) = "state,omitempty", (gogoproto.moretags) = "yaml:\"state\""];
  string cluster_id = 2 [(gogoproto.jsontag) = "cluster_id,omitempty", (gogoproto.moretags) = "yaml:\"cluster_id\""];
  cosmos.base.query.v1beta1.PageRequest pagination = 3 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryJobsResponse is the response for Query/Jobs
message QueryJobsResponse {
  repeated HPCJob jobs = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "jobs", (gogoproto.moretags) = "yaml:\"jobs\""];
  cosmos.base.query.v1beta1.PageResponse pagination = 2 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryJobsByCustomerRequest is the request for Query/JobsByCustomer
message QueryJobsByCustomerRequest {
  string customer_address = 1 [(cosmos_proto.scalar) = "cosmos.AddressString", (gogoproto.jsontag) = "customer_address", (gogoproto.moretags) = "yaml:\"customer_address\""];
  cosmos.base.query.v1beta1.PageRequest pagination = 2 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryJobsByCustomerResponse is the response for Query/JobsByCustomer
message QueryJobsByCustomerResponse {
  repeated HPCJob jobs = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "jobs", (gogoproto.moretags) = "yaml:\"jobs\""];
  cosmos.base.query.v1beta1.PageResponse pagination = 2 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryJobsByProviderRequest is the request for Query/JobsByProvider
message QueryJobsByProviderRequest {
  string provider_address = 1 [(cosmos_proto.scalar) = "cosmos.AddressString", (gogoproto.jsontag) = "provider_address", (gogoproto.moretags) = "yaml:\"provider_address\""];
  cosmos.base.query.v1beta1.PageRequest pagination = 2 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryJobsByProviderResponse is the response for Query/JobsByProvider
message QueryJobsByProviderResponse {
  repeated HPCJob jobs = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "jobs", (gogoproto.moretags) = "yaml:\"jobs\""];
  cosmos.base.query.v1beta1.PageResponse pagination = 2 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryJobAccountingRequest is the request for Query/JobAccounting
message QueryJobAccountingRequest {
  string job_id = 1 [(gogoproto.jsontag) = "job_id", (gogoproto.moretags) = "yaml:\"job_id\""];
}

// QueryJobAccountingResponse is the response for Query/JobAccounting
message QueryJobAccountingResponse {
  JobAccounting accounting = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "accounting", (gogoproto.moretags) = "yaml:\"accounting\""];
}

// QueryNodeMetadataRequest is the request for Query/NodeMetadata
message QueryNodeMetadataRequest {
  string node_id = 1 [(gogoproto.jsontag) = "node_id", (gogoproto.moretags) = "yaml:\"node_id\""];
}

// QueryNodeMetadataResponse is the response for Query/NodeMetadata
message QueryNodeMetadataResponse {
  NodeMetadata node = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "node", (gogoproto.moretags) = "yaml:\"node\""];
}

// QueryNodesByClusterRequest is the request for Query/NodesByCluster
message QueryNodesByClusterRequest {
  string cluster_id = 1 [(gogoproto.jsontag) = "cluster_id", (gogoproto.moretags) = "yaml:\"cluster_id\""];
  cosmos.base.query.v1beta1.PageRequest pagination = 2 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryNodesByClusterResponse is the response for Query/NodesByCluster
message QueryNodesByClusterResponse {
  repeated NodeMetadata nodes = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "nodes", (gogoproto.moretags) = "yaml:\"nodes\""];
  cosmos.base.query.v1beta1.PageResponse pagination = 2 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QuerySchedulingDecisionRequest is the request for Query/SchedulingDecision
message QuerySchedulingDecisionRequest {
  string decision_id = 1 [(gogoproto.jsontag) = "decision_id", (gogoproto.moretags) = "yaml:\"decision_id\""];
}

// QuerySchedulingDecisionResponse is the response for Query/SchedulingDecision
message QuerySchedulingDecisionResponse {
  SchedulingDecision decision = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "decision", (gogoproto.moretags) = "yaml:\"decision\""];
}

// QuerySchedulingDecisionByJobRequest is the request for Query/SchedulingDecisionByJob
message QuerySchedulingDecisionByJobRequest {
  string job_id = 1 [(gogoproto.jsontag) = "job_id", (gogoproto.moretags) = "yaml:\"job_id\""];
}

// QuerySchedulingDecisionByJobResponse is the response for Query/SchedulingDecisionByJob
message QuerySchedulingDecisionByJobResponse {
  SchedulingDecision decision = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "decision", (gogoproto.moretags) = "yaml:\"decision\""];
}

// QueryRewardRequest is the request for Query/Reward
message QueryRewardRequest {
  string reward_id = 1 [(gogoproto.jsontag) = "reward_id", (gogoproto.moretags) = "yaml:\"reward_id\""];
}

// QueryRewardResponse is the response for Query/Reward
message QueryRewardResponse {
  HPCRewardRecord reward = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "reward", (gogoproto.moretags) = "yaml:\"reward\""];
}

// QueryRewardsByJobRequest is the request for Query/RewardsByJob
message QueryRewardsByJobRequest {
  string job_id = 1 [(gogoproto.jsontag) = "job_id", (gogoproto.moretags) = "yaml:\"job_id\""];
}

// QueryRewardsByJobResponse is the response for Query/RewardsByJob
message QueryRewardsByJobResponse {
  repeated HPCRewardRecord rewards = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "rewards", (gogoproto.moretags) = "yaml:\"rewards\""];
}

// QueryDisputeRequest is the request for Query/Dispute
message QueryDisputeRequest {
  string dispute_id = 1 [(gogoproto.jsontag) = "dispute_id", (gogoproto.moretags) = "yaml:\"dispute_id\""];
}

// QueryDisputeResponse is the response for Query/Dispute
message QueryDisputeResponse {
  HPCDispute dispute = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "dispute", (gogoproto.moretags) = "yaml:\"dispute\""];
}

// QueryDisputesRequest is the request for Query/Disputes
message QueryDisputesRequest {
  DisputeStatus status = 1 [(gogoproto.jsontag) = "status,omitempty", (gogoproto.moretags) = "yaml:\"status\""];
  cosmos.base.query.v1beta1.PageRequest pagination = 2 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryDisputesResponse is the response for Query/Disputes
message QueryDisputesResponse {
  repeated HPCDispute disputes = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "disputes", (gogoproto.moretags) = "yaml:\"disputes\""];
  cosmos.base.query.v1beta1.PageResponse pagination = 2 [(gogoproto.jsontag) = "pagination,omitempty", (gogoproto.moretags) = "yaml:\"pagination\""];
}

// QueryParamsRequest is the request for Query/Params
message QueryParamsRequest {}

// QueryParamsResponse is the response for Query/Params
message QueryParamsResponse {
  Params params = 1 [(gogoproto.nullable) = false, (gogoproto.jsontag) = "params", (gogoproto.moretags) = "yaml:\"params\""];
}
