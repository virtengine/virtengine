syntax = "proto3";
package virtengine.mfa.v1;

import "gogoproto/gogo.proto";
import "cosmos_proto/cosmos.proto";
import "amino/amino.proto";

option go_package = "github.com/virtengine/virtengine/sdk/go/node/mfa/v1";

// FactorType represents the type of authentication factor
enum FactorType {
  option (gogoproto.goproto_enum_prefix) = false;

  // FACTOR_TYPE_UNSPECIFIED represents an unspecified factor type
  FACTOR_TYPE_UNSPECIFIED = 0 [(gogoproto.enumvalue_customname) = "FactorTypeUnspecified"];

  // FACTOR_TYPE_TOTP represents Time-based One-Time Password
  FACTOR_TYPE_TOTP = 1 [(gogoproto.enumvalue_customname) = "FactorTypeTOTP"];

  // FACTOR_TYPE_FIDO2 represents FIDO2/WebAuthn authentication
  FACTOR_TYPE_FIDO2 = 2 [(gogoproto.enumvalue_customname) = "FactorTypeFIDO2"];

  // FACTOR_TYPE_SMS represents SMS OTP authentication
  FACTOR_TYPE_SMS = 3 [(gogoproto.enumvalue_customname) = "FactorTypeSMS"];

  // FACTOR_TYPE_EMAIL represents Email OTP authentication
  FACTOR_TYPE_EMAIL = 4 [(gogoproto.enumvalue_customname) = "FactorTypeEmail"];

  // FACTOR_TYPE_VEID represents VEID identity score threshold
  FACTOR_TYPE_VEID = 5 [(gogoproto.enumvalue_customname) = "FactorTypeVEID"];

  // FACTOR_TYPE_TRUSTED_DEVICE represents trusted browser/device binding
  FACTOR_TYPE_TRUSTED_DEVICE = 6 [(gogoproto.enumvalue_customname) = "FactorTypeTrustedDevice"];

  // FACTOR_TYPE_HARDWARE_KEY represents X.509/smart card/PIV hardware key authentication
  FACTOR_TYPE_HARDWARE_KEY = 7 [(gogoproto.enumvalue_customname) = "FactorTypeHardwareKey"];
}

// FactorSecurityLevel represents the security level of a factor
enum FactorSecurityLevel {
  option (gogoproto.goproto_enum_prefix) = false;

  // FACTOR_SECURITY_LEVEL_UNSPECIFIED represents an unspecified security level
  FACTOR_SECURITY_LEVEL_UNSPECIFIED = 0 [(gogoproto.enumvalue_customname) = "FactorSecurityLevelUnspecified"];

  // FACTOR_SECURITY_LEVEL_LOW represents low security factors (email, SMS)
  FACTOR_SECURITY_LEVEL_LOW = 1 [(gogoproto.enumvalue_customname) = "FactorSecurityLevelLow"];

  // FACTOR_SECURITY_LEVEL_MEDIUM represents medium security factors (TOTP)
  FACTOR_SECURITY_LEVEL_MEDIUM = 2 [(gogoproto.enumvalue_customname) = "FactorSecurityLevelMedium"];

  // FACTOR_SECURITY_LEVEL_HIGH represents high security factors (FIDO2, VEID)
  FACTOR_SECURITY_LEVEL_HIGH = 3 [(gogoproto.enumvalue_customname) = "FactorSecurityLevelHigh"];
}

// FactorEnrollmentStatus represents the status of a factor enrollment
enum FactorEnrollmentStatus {
  option (gogoproto.goproto_enum_prefix) = false;

  // ENROLLMENT_STATUS_UNSPECIFIED represents an unspecified status
  ENROLLMENT_STATUS_UNSPECIFIED = 0 [(gogoproto.enumvalue_customname) = "EnrollmentStatusUnspecified"];

  // ENROLLMENT_STATUS_PENDING represents a pending enrollment awaiting verification
  ENROLLMENT_STATUS_PENDING = 1 [(gogoproto.enumvalue_customname) = "EnrollmentStatusPending"];

  // ENROLLMENT_STATUS_ACTIVE represents an active, verified enrollment
  ENROLLMENT_STATUS_ACTIVE = 2 [(gogoproto.enumvalue_customname) = "EnrollmentStatusActive"];

  // ENROLLMENT_STATUS_REVOKED represents a revoked enrollment
  ENROLLMENT_STATUS_REVOKED = 3 [(gogoproto.enumvalue_customname) = "EnrollmentStatusRevoked"];

  // ENROLLMENT_STATUS_EXPIRED represents an expired enrollment
  ENROLLMENT_STATUS_EXPIRED = 4 [(gogoproto.enumvalue_customname) = "EnrollmentStatusExpired"];
}

// ChallengeStatus represents the status of an MFA challenge
enum ChallengeStatus {
  option (gogoproto.goproto_enum_prefix) = false;

  // CHALLENGE_STATUS_UNSPECIFIED represents an unspecified status
  CHALLENGE_STATUS_UNSPECIFIED = 0 [(gogoproto.enumvalue_customname) = "ChallengeStatusUnspecified"];

  // CHALLENGE_STATUS_PENDING represents a challenge awaiting response
  CHALLENGE_STATUS_PENDING = 1 [(gogoproto.enumvalue_customname) = "ChallengeStatusPending"];

  // CHALLENGE_STATUS_VERIFIED represents a successfully verified challenge
  CHALLENGE_STATUS_VERIFIED = 2 [(gogoproto.enumvalue_customname) = "ChallengeStatusVerified"];

  // CHALLENGE_STATUS_FAILED represents a failed challenge
  CHALLENGE_STATUS_FAILED = 3 [(gogoproto.enumvalue_customname) = "ChallengeStatusFailed"];

  // CHALLENGE_STATUS_EXPIRED represents an expired challenge
  CHALLENGE_STATUS_EXPIRED = 4 [(gogoproto.enumvalue_customname) = "ChallengeStatusExpired"];

  // CHALLENGE_STATUS_CANCELLED represents a cancelled challenge
  CHALLENGE_STATUS_CANCELLED = 5 [(gogoproto.enumvalue_customname) = "ChallengeStatusCancelled"];
}

// SensitiveTransactionType represents types of transactions that require MFA
enum SensitiveTransactionType {
  option (gogoproto.goproto_enum_prefix) = false;

  // SENSITIVE_TX_UNSPECIFIED represents an unspecified transaction type
  SENSITIVE_TX_UNSPECIFIED = 0 [(gogoproto.enumvalue_customname) = "SensitiveTxUnspecified"];

  // SENSITIVE_TX_ACCOUNT_RECOVERY represents account recovery operations
  SENSITIVE_TX_ACCOUNT_RECOVERY = 1 [(gogoproto.enumvalue_customname) = "SensitiveTxAccountRecovery"];

  // SENSITIVE_TX_KEY_ROTATION represents key rotation operations
  SENSITIVE_TX_KEY_ROTATION = 2 [(gogoproto.enumvalue_customname) = "SensitiveTxKeyRotation"];

  // SENSITIVE_TX_LARGE_WITHDRAWAL represents large token withdrawals
  SENSITIVE_TX_LARGE_WITHDRAWAL = 3 [(gogoproto.enumvalue_customname) = "SensitiveTxLargeWithdrawal"];

  // SENSITIVE_TX_PROVIDER_REGISTRATION represents provider registration
  SENSITIVE_TX_PROVIDER_REGISTRATION = 4 [(gogoproto.enumvalue_customname) = "SensitiveTxProviderRegistration"];

  // SENSITIVE_TX_VALIDATOR_REGISTRATION represents validator registration
  SENSITIVE_TX_VALIDATOR_REGISTRATION = 5 [(gogoproto.enumvalue_customname) = "SensitiveTxValidatorRegistration"];

  // SENSITIVE_TX_HIGH_VALUE_ORDER represents high-value marketplace orders
  SENSITIVE_TX_HIGH_VALUE_ORDER = 6 [(gogoproto.enumvalue_customname) = "SensitiveTxHighValueOrder"];

  // SENSITIVE_TX_ROLE_ASSIGNMENT represents role assignment operations
  SENSITIVE_TX_ROLE_ASSIGNMENT = 7 [(gogoproto.enumvalue_customname) = "SensitiveTxRoleAssignment"];

  // SENSITIVE_TX_GOVERNANCE_PROPOSAL represents governance proposal creation
  SENSITIVE_TX_GOVERNANCE_PROPOSAL = 8 [(gogoproto.enumvalue_customname) = "SensitiveTxGovernanceProposal"];

  // SENSITIVE_TX_PRIMARY_EMAIL_CHANGE represents primary email changes
  SENSITIVE_TX_PRIMARY_EMAIL_CHANGE = 9 [(gogoproto.enumvalue_customname) = "SensitiveTxPrimaryEmailChange"];

  // SENSITIVE_TX_PHONE_NUMBER_CHANGE represents phone number changes
  SENSITIVE_TX_PHONE_NUMBER_CHANGE = 10 [(gogoproto.enumvalue_customname) = "SensitiveTxPhoneNumberChange"];

  // SENSITIVE_TX_TWO_FACTOR_DISABLE represents disabling 2FA
  SENSITIVE_TX_TWO_FACTOR_DISABLE = 11 [(gogoproto.enumvalue_customname) = "SensitiveTxTwoFactorDisable"];

  // SENSITIVE_TX_ACCOUNT_DELETION represents account deletion
  SENSITIVE_TX_ACCOUNT_DELETION = 12 [(gogoproto.enumvalue_customname) = "SensitiveTxAccountDeletion"];

  // SENSITIVE_TX_GOVERNANCE_VOTE represents high-stake governance votes
  SENSITIVE_TX_GOVERNANCE_VOTE = 13 [(gogoproto.enumvalue_customname) = "SensitiveTxGovernanceVote"];

  // SENSITIVE_TX_FIRST_OFFERING_CREATE represents first offering creation by provider
  SENSITIVE_TX_FIRST_OFFERING_CREATE = 14 [(gogoproto.enumvalue_customname) = "SensitiveTxFirstOfferingCreate"];

  // SENSITIVE_TX_TRANSFER_TO_NEW_ADDRESS represents transfers to new addresses
  SENSITIVE_TX_TRANSFER_TO_NEW_ADDRESS = 15 [(gogoproto.enumvalue_customname) = "SensitiveTxTransferToNewAddress"];

  // SENSITIVE_TX_MEDIUM_WITHDRAWAL represents medium-value withdrawals
  SENSITIVE_TX_MEDIUM_WITHDRAWAL = 16 [(gogoproto.enumvalue_customname) = "SensitiveTxMediumWithdrawal"];

  // SENSITIVE_TX_API_KEY_GENERATION represents API key generation
  SENSITIVE_TX_API_KEY_GENERATION = 17 [(gogoproto.enumvalue_customname) = "SensitiveTxAPIKeyGeneration"];

  // SENSITIVE_TX_WEBHOOK_CONFIGURATION represents webhook configuration
  SENSITIVE_TX_WEBHOOK_CONFIGURATION = 18 [(gogoproto.enumvalue_customname) = "SensitiveTxWebhookConfiguration"];
}

// HardwareKeyType represents the type of hardware key
enum HardwareKeyType {
  option (gogoproto.goproto_enum_prefix) = false;

  // HARDWARE_KEY_TYPE_UNSPECIFIED represents an unspecified hardware key type
  HARDWARE_KEY_TYPE_UNSPECIFIED = 0 [(gogoproto.enumvalue_customname) = "HardwareKeyTypeUnspecified"];

  // HARDWARE_KEY_TYPE_X509 represents X.509 certificate-based authentication
  HARDWARE_KEY_TYPE_X509 = 1 [(gogoproto.enumvalue_customname) = "HardwareKeyTypeX509"];

  // HARDWARE_KEY_TYPE_SMART_CARD represents smart card/PIV authentication
  HARDWARE_KEY_TYPE_SMART_CARD = 2 [(gogoproto.enumvalue_customname) = "HardwareKeyTypeSmartCard"];

  // HARDWARE_KEY_TYPE_PIV represents PIV (Personal Identity Verification) card
  HARDWARE_KEY_TYPE_PIV = 3 [(gogoproto.enumvalue_customname) = "HardwareKeyTypePIV"];
}

// RevocationStatus represents the revocation status of a certificate
enum RevocationStatus {
  option (gogoproto.goproto_enum_prefix) = false;

  // REVOCATION_STATUS_UNKNOWN indicates the revocation status is unknown
  REVOCATION_STATUS_UNKNOWN = 0 [(gogoproto.enumvalue_customname) = "RevocationStatusUnknown"];

  // REVOCATION_STATUS_GOOD indicates the certificate is not revoked
  REVOCATION_STATUS_GOOD = 1 [(gogoproto.enumvalue_customname) = "RevocationStatusGood"];

  // REVOCATION_STATUS_REVOKED indicates the certificate has been revoked
  REVOCATION_STATUS_REVOKED = 2 [(gogoproto.enumvalue_customname) = "RevocationStatusRevoked"];

  // REVOCATION_STATUS_CHECK_FAILED indicates the revocation check failed
  REVOCATION_STATUS_CHECK_FAILED = 3 [(gogoproto.enumvalue_customname) = "RevocationStatusCheckFailed"];
}

// MFAProof represents proof of MFA verification
message MFAProof {
  option (gogoproto.equal) = true;

  // SessionID is the authorization session ID
  string session_id = 1 [
    (gogoproto.jsontag) = "session_id",
    (gogoproto.moretags) = "yaml:\"session_id\""
  ];

  // VerifiedFactors are the factors that were verified
  repeated FactorType verified_factors = 2 [
    (gogoproto.jsontag) = "verified_factors",
    (gogoproto.moretags) = "yaml:\"verified_factors\""
  ];

  // Timestamp is when the proof was generated (Unix timestamp)
  int64 timestamp = 3 [
    (gogoproto.jsontag) = "timestamp",
    (gogoproto.moretags) = "yaml:\"timestamp\""
  ];

  // Signature is the signature over the proof data
  bytes signature = 4 [
    (gogoproto.jsontag) = "signature,omitempty",
    (gogoproto.moretags) = "yaml:\"signature\""
  ];
}

// FactorCombination represents a set of factors that must ALL be satisfied (AND logic)
message FactorCombination {
  option (gogoproto.equal) = true;

  // Factors is the list of factor types that must all be verified
  repeated FactorType factors = 1 [
    (gogoproto.jsontag) = "factors",
    (gogoproto.moretags) = "yaml:\"factors\""
  ];

  // MinSecurityLevel is the minimum security level required for the combination
  FactorSecurityLevel min_security_level = 2 [
    (gogoproto.jsontag) = "min_security_level",
    (gogoproto.moretags) = "yaml:\"min_security_level\""
  ];
}

// FactorMetadata contains type-specific metadata for enrollments
message FactorMetadata {
  option (gogoproto.equal) = true;

  // VEIDThreshold is the minimum VEID score required (for VEID factor)
  uint32 veid_threshold = 1 [
    (gogoproto.jsontag) = "veid_threshold,omitempty",
    (gogoproto.moretags) = "yaml:\"veid_threshold\""
  ];

  // DeviceInfo contains device information (for TrustedDevice factor)
  DeviceInfo device_info = 2 [
    (gogoproto.jsontag) = "device_info,omitempty",
    (gogoproto.moretags) = "yaml:\"device_info\""
  ];

  // FIDO2Info contains FIDO2-specific metadata
  FIDO2CredentialInfo fido2_info = 3 [
    (gogoproto.jsontag) = "fido2_info,omitempty",
    (gogoproto.moretags) = "yaml:\"fido2_info\""
  ];

  // ContactHash contains a hash of the contact info (for SMS/Email verification tracking)
  string contact_hash = 4 [
    (gogoproto.jsontag) = "contact_hash,omitempty",
    (gogoproto.moretags) = "yaml:\"contact_hash\""
  ];

  // HardwareKeyInfo contains hardware key/X.509/smart card metadata
  HardwareKeyEnrollment hardware_key_info = 5 [
    (gogoproto.jsontag) = "hardware_key_info,omitempty",
    (gogoproto.moretags) = "yaml:\"hardware_key_info\""
  ];
}

// DeviceInfo contains information about a trusted device
message DeviceInfo {
  option (gogoproto.equal) = true;

  // Fingerprint is a unique hash identifying the device
  string fingerprint = 1 [
    (gogoproto.jsontag) = "fingerprint",
    (gogoproto.moretags) = "yaml:\"fingerprint\""
  ];

  // UserAgent is the user agent string (sanitized)
  string user_agent = 2 [
    (gogoproto.jsontag) = "user_agent,omitempty",
    (gogoproto.moretags) = "yaml:\"user_agent\""
  ];

  // FirstSeenAt is when this device was first seen
  int64 first_seen_at = 3 [
    (gogoproto.jsontag) = "first_seen_at",
    (gogoproto.moretags) = "yaml:\"first_seen_at\""
  ];

  // LastSeenAt is when this device was last seen
  int64 last_seen_at = 4 [
    (gogoproto.jsontag) = "last_seen_at",
    (gogoproto.moretags) = "yaml:\"last_seen_at\""
  ];

  // IPHash is a hash of the last known IP (for change detection, not tracking)
  string ip_hash = 5 [
    (gogoproto.jsontag) = "ip_hash,omitempty",
    (gogoproto.moretags) = "yaml:\"ip_hash\""
  ];

  // TrustExpiresAt is when the device trust expires
  int64 trust_expires_at = 6 [
    (gogoproto.jsontag) = "trust_expires_at",
    (gogoproto.moretags) = "yaml:\"trust_expires_at\""
  ];
}

// FIDO2CredentialInfo contains FIDO2-specific credential information
message FIDO2CredentialInfo {
  option (gogoproto.equal) = true;

  // CredentialID is the FIDO2 credential identifier
  bytes credential_id = 1 [
    (gogoproto.jsontag) = "credential_id",
    (gogoproto.moretags) = "yaml:\"credential_id\""
  ];

  // PublicKey is the COSE-encoded public key
  bytes public_key = 2 [
    (gogoproto.jsontag) = "public_key",
    (gogoproto.moretags) = "yaml:\"public_key\""
  ];

  // AAGUID is the Authenticator Attestation GUID
  bytes aaguid = 3 [
    (gogoproto.jsontag) = "aaguid,omitempty",
    (gogoproto.moretags) = "yaml:\"aaguid\""
  ];

  // SignCount is the signature counter for clone detection
  uint32 sign_count = 4 [
    (gogoproto.jsontag) = "sign_count",
    (gogoproto.moretags) = "yaml:\"sign_count\""
  ];

  // AttestationType indicates the attestation type used
  string attestation_type = 5 [
    (gogoproto.jsontag) = "attestation_type,omitempty",
    (gogoproto.moretags) = "yaml:\"attestation_type\""
  ];
}

// HardwareKeyEnrollment represents a hardware key enrollment for MFA
message HardwareKeyEnrollment {
  option (gogoproto.equal) = true;

  // KeyType is the type of hardware key
  HardwareKeyType key_type = 1 [
    (gogoproto.jsontag) = "key_type",
    (gogoproto.moretags) = "yaml:\"key_type\""
  ];

  // KeyID is a unique identifier for this key (certificate fingerprint or card serial)
  string key_id = 2 [
    (gogoproto.jsontag) = "key_id",
    (gogoproto.moretags) = "yaml:\"key_id\""
  ];

  // SubjectDN is the distinguished name from the certificate subject
  string subject_dn = 3 [
    (gogoproto.jsontag) = "subject_dn,omitempty",
    (gogoproto.moretags) = "yaml:\"subject_dn\""
  ];

  // IssuerDN is the distinguished name of the certificate issuer
  string issuer_dn = 4 [
    (gogoproto.jsontag) = "issuer_dn,omitempty",
    (gogoproto.moretags) = "yaml:\"issuer_dn\""
  ];

  // SerialNumber is the certificate serial number (hex encoded)
  string serial_number = 5 [
    (gogoproto.jsontag) = "serial_number,omitempty",
    (gogoproto.moretags) = "yaml:\"serial_number\""
  ];

  // PublicKeyFingerprint is SHA-256 hash of the public key (hex encoded)
  string public_key_fingerprint = 6 [
    (gogoproto.jsontag) = "public_key_fingerprint",
    (gogoproto.moretags) = "yaml:\"public_key_fingerprint\""
  ];

  // NotBefore is the certificate validity start time
  int64 not_before = 7 [
    (gogoproto.jsontag) = "not_before",
    (gogoproto.moretags) = "yaml:\"not_before\""
  ];

  // NotAfter is the certificate validity end time
  int64 not_after = 8 [
    (gogoproto.jsontag) = "not_after",
    (gogoproto.moretags) = "yaml:\"not_after\""
  ];

  // KeyUsage indicates the allowed key usage flags
  repeated string key_usage = 9 [
    (gogoproto.jsontag) = "key_usage,omitempty",
    (gogoproto.moretags) = "yaml:\"key_usage\""
  ];

  // ExtendedKeyUsage indicates extended key usage purposes
  repeated string extended_key_usage = 10 [
    (gogoproto.jsontag) = "extended_key_usage,omitempty",
    (gogoproto.moretags) = "yaml:\"extended_key_usage\""
  ];

  // SmartCardInfo contains smart card specific metadata
  SmartCardInfo smart_card_info = 11 [
    (gogoproto.jsontag) = "smart_card_info,omitempty",
    (gogoproto.moretags) = "yaml:\"smart_card_info\""
  ];

  // RevocationCheckEnabled indicates if revocation checking is enabled
  bool revocation_check_enabled = 12 [
    (gogoproto.jsontag) = "revocation_check_enabled",
    (gogoproto.moretags) = "yaml:\"revocation_check_enabled\""
  ];

  // LastRevocationCheck is the timestamp of the last revocation check
  int64 last_revocation_check = 13 [
    (gogoproto.jsontag) = "last_revocation_check,omitempty",
    (gogoproto.moretags) = "yaml:\"last_revocation_check\""
  ];

  // RevocationStatus is the current revocation status
  RevocationStatus revocation_status = 14 [
    (gogoproto.jsontag) = "revocation_status",
    (gogoproto.moretags) = "yaml:\"revocation_status\""
  ];

  // TrustedCACertFingerprints are the fingerprints of trusted CA certificates
  repeated string trusted_ca_cert_fingerprints = 15 [
    (gogoproto.jsontag) = "trusted_ca_cert_fingerprints,omitempty",
    (gogoproto.moretags) = "yaml:\"trusted_ca_cert_fingerprints\""
  ];
}

// SmartCardInfo contains smart card/PIV specific information
message SmartCardInfo {
  option (gogoproto.equal) = true;

  // CardSerialNumber is the smart card serial number
  string card_serial_number = 1 [
    (gogoproto.jsontag) = "card_serial_number",
    (gogoproto.moretags) = "yaml:\"card_serial_number\""
  ];

  // CardType indicates the type of smart card (PIV, CAC, etc.)
  string card_type = 2 [
    (gogoproto.jsontag) = "card_type",
    (gogoproto.moretags) = "yaml:\"card_type\""
  ];

  // SlotID indicates which slot the certificate was read from
  string slot_id = 3 [
    (gogoproto.jsontag) = "slot_id,omitempty",
    (gogoproto.moretags) = "yaml:\"slot_id\""
  ];

  // CHUID is the Card Holder Unique Identifier (for PIV cards)
  string chuid = 4 [
    (gogoproto.jsontag) = "chuid,omitempty",
    (gogoproto.moretags) = "yaml:\"chuid\""
  ];

  // FASC_N is the Federal Agency Smart Credential Number (if available)
  string fascn = 5 [
    (gogoproto.jsontag) = "fascn,omitempty",
    (gogoproto.moretags) = "yaml:\"fascn\""
  ];

  // CardHolderName is the name on the card (from CHUID or certificate)
  string card_holder_name = 6 [
    (gogoproto.jsontag) = "card_holder_name,omitempty",
    (gogoproto.moretags) = "yaml:\"card_holder_name\""
  ];

  // ExpirationDate is when the card expires
  int64 expiration_date = 7 [
    (gogoproto.jsontag) = "expiration_date,omitempty",
    (gogoproto.moretags) = "yaml:\"expiration_date\""
  ];

  // LastPINVerification is when PIN was last verified
  int64 last_pin_verification = 8 [
    (gogoproto.jsontag) = "last_pin_verification,omitempty",
    (gogoproto.moretags) = "yaml:\"last_pin_verification\""
  ];
}

// FactorEnrollment represents a factor enrollment record
message FactorEnrollment {
  option (gogoproto.equal) = true;

  // AccountAddress is the account that owns this enrollment
  string account_address = 1 [
    (cosmos_proto.scalar) = "cosmos.AddressString",
    (gogoproto.jsontag) = "account_address",
    (gogoproto.moretags) = "yaml:\"account_address\""
  ];

  // FactorType is the type of factor
  FactorType factor_type = 2 [
    (gogoproto.jsontag) = "factor_type",
    (gogoproto.moretags) = "yaml:\"factor_type\""
  ];

  // FactorID is a unique identifier for this factor enrollment
  string factor_id = 3 [
    (gogoproto.jsontag) = "factor_id",
    (gogoproto.moretags) = "yaml:\"factor_id\""
  ];

  // PublicIdentifier is the public component of the factor
  bytes public_identifier = 4 [
    (gogoproto.jsontag) = "public_identifier,omitempty",
    (gogoproto.moretags) = "yaml:\"public_identifier\""
  ];

  // Label is a user-friendly label for the factor
  string label = 5 [
    (gogoproto.jsontag) = "label",
    (gogoproto.moretags) = "yaml:\"label\""
  ];

  // Status is the current enrollment status
  FactorEnrollmentStatus status = 6 [
    (gogoproto.jsontag) = "status",
    (gogoproto.moretags) = "yaml:\"status\""
  ];

  // EnrolledAt is the timestamp when the factor was enrolled
  int64 enrolled_at = 7 [
    (gogoproto.jsontag) = "enrolled_at",
    (gogoproto.moretags) = "yaml:\"enrolled_at\""
  ];

  // VerifiedAt is the timestamp when the enrollment was verified
  int64 verified_at = 8 [
    (gogoproto.jsontag) = "verified_at,omitempty",
    (gogoproto.moretags) = "yaml:\"verified_at\""
  ];

  // RevokedAt is the timestamp when the factor was revoked
  int64 revoked_at = 9 [
    (gogoproto.jsontag) = "revoked_at,omitempty",
    (gogoproto.moretags) = "yaml:\"revoked_at\""
  ];

  // LastUsedAt is the timestamp of the last successful use
  int64 last_used_at = 10 [
    (gogoproto.jsontag) = "last_used_at,omitempty",
    (gogoproto.moretags) = "yaml:\"last_used_at\""
  ];

  // UseCount tracks how many times this factor has been used
  uint64 use_count = 11 [
    (gogoproto.jsontag) = "use_count",
    (gogoproto.moretags) = "yaml:\"use_count\""
  ];

  // Metadata contains additional factor-specific metadata
  FactorMetadata metadata = 12 [
    (gogoproto.jsontag) = "metadata,omitempty",
    (gogoproto.moretags) = "yaml:\"metadata\""
  ];
}

// TrustedDevicePolicy defines how trusted devices can reduce MFA requirements
message TrustedDevicePolicy {
  option (gogoproto.equal) = true;

  // Enabled indicates if trusted device reduction is enabled
  bool enabled = 1 [
    (gogoproto.jsontag) = "enabled",
    (gogoproto.moretags) = "yaml:\"enabled\""
  ];

  // TrustDuration is how long a device remains trusted (in seconds)
  int64 trust_duration = 2 [
    (gogoproto.jsontag) = "trust_duration",
    (gogoproto.moretags) = "yaml:\"trust_duration\""
  ];

  // ReducedFactors is the factor combination to use for trusted devices
  FactorCombination reduced_factors = 3 [
    (gogoproto.jsontag) = "reduced_factors,omitempty",
    (gogoproto.moretags) = "yaml:\"reduced_factors\""
  ];

  // MaxTrustedDevices is the maximum number of trusted devices per account
  uint32 max_trusted_devices = 4 [
    (gogoproto.jsontag) = "max_trusted_devices",
    (gogoproto.moretags) = "yaml:\"max_trusted_devices\""
  ];

  // RequireReauthForSensitive if true, still requires full MFA for critical actions
  bool require_reauth_for_sensitive = 5 [
    (gogoproto.jsontag) = "require_reauth_for_sensitive",
    (gogoproto.moretags) = "yaml:\"require_reauth_for_sensitive\""
  ];
}

// MFAPolicy defines the MFA requirements for an account
message MFAPolicy {
  option (gogoproto.equal) = true;

  // AccountAddress is the account this policy applies to
  string account_address = 1 [
    (cosmos_proto.scalar) = "cosmos.AddressString",
    (gogoproto.jsontag) = "account_address",
    (gogoproto.moretags) = "yaml:\"account_address\""
  ];

  // RequiredFactors is a list of factor combinations (OR logic between combinations)
  repeated FactorCombination required_factors = 2 [
    (gogoproto.nullable) = false,
    (gogoproto.jsontag) = "required_factors",
    (gogoproto.moretags) = "yaml:\"required_factors\""
  ];

  // TrustedDeviceRule defines how trusted devices affect MFA requirements
  TrustedDevicePolicy trusted_device_rule = 3 [
    (gogoproto.jsontag) = "trusted_device_rule,omitempty",
    (gogoproto.moretags) = "yaml:\"trusted_device_rule\""
  ];

  // RecoveryFactors defines factor combinations for account recovery
  repeated FactorCombination recovery_factors = 4 [
    (gogoproto.nullable) = false,
    (gogoproto.jsontag) = "recovery_factors",
    (gogoproto.moretags) = "yaml:\"recovery_factors\""
  ];

  // KeyRotationFactors defines factor combinations for key rotation
  repeated FactorCombination key_rotation_factors = 5 [
    (gogoproto.nullable) = false,
    (gogoproto.jsontag) = "key_rotation_factors",
    (gogoproto.moretags) = "yaml:\"key_rotation_factors\""
  ];

  // SessionDuration is how long an MFA session remains valid (in seconds)
  int64 session_duration = 6 [
    (gogoproto.jsontag) = "session_duration",
    (gogoproto.moretags) = "yaml:\"session_duration\""
  ];

  // VEIDThreshold is the minimum VEID score required for VEID-based factors
  uint32 veid_threshold = 7 [
    (gogoproto.jsontag) = "veid_threshold,omitempty",
    (gogoproto.moretags) = "yaml:\"veid_threshold\""
  ];

  // Enabled indicates if MFA is enabled for this account
  bool enabled = 8 [
    (gogoproto.jsontag) = "enabled",
    (gogoproto.moretags) = "yaml:\"enabled\""
  ];

  // CreatedAt is when the policy was created
  int64 created_at = 9 [
    (gogoproto.jsontag) = "created_at",
    (gogoproto.moretags) = "yaml:\"created_at\""
  ];

  // UpdatedAt is when the policy was last updated
  int64 updated_at = 10 [
    (gogoproto.jsontag) = "updated_at",
    (gogoproto.moretags) = "yaml:\"updated_at\""
  ];
}

// ClientInfo contains information about the requesting client
message ClientInfo {
  option (gogoproto.equal) = true;

  // DeviceFingerprint is a hash identifying the device
  string device_fingerprint = 1 [
    (gogoproto.jsontag) = "device_fingerprint,omitempty",
    (gogoproto.moretags) = "yaml:\"device_fingerprint\""
  ];

  // IPHash is a hash of the client IP
  string ip_hash = 2 [
    (gogoproto.jsontag) = "ip_hash,omitempty",
    (gogoproto.moretags) = "yaml:\"ip_hash\""
  ];

  // UserAgent is the sanitized user agent string
  string user_agent = 3 [
    (gogoproto.jsontag) = "user_agent,omitempty",
    (gogoproto.moretags) = "yaml:\"user_agent\""
  ];

  // RequestedAt is when the request was made
  int64 requested_at = 4 [
    (gogoproto.jsontag) = "requested_at",
    (gogoproto.moretags) = "yaml:\"requested_at\""
  ];
}

// ChallengeMetadata contains additional challenge information
message ChallengeMetadata {
  option (gogoproto.equal) = true;

  // FIDO2Challenge contains FIDO2-specific challenge data
  FIDO2ChallengeData fido2_challenge = 1 [
    (gogoproto.jsontag) = "fido2_challenge,omitempty",
    (gogoproto.moretags) = "yaml:\"fido2_challenge\""
  ];

  // OTPInfo contains OTP-specific tracking data
  OTPChallengeInfo otp_info = 2 [
    (gogoproto.jsontag) = "otp_info,omitempty",
    (gogoproto.moretags) = "yaml:\"otp_info\""
  ];

  // ClientInfo contains information about the requesting client
  ClientInfo client_info = 3 [
    (gogoproto.jsontag) = "client_info,omitempty",
    (gogoproto.moretags) = "yaml:\"client_info\""
  ];

  // HardwareKeyChallenge contains hardware key challenge data
  HardwareKeyChallenge hardware_key_challenge = 4 [
    (gogoproto.jsontag) = "hardware_key_challenge,omitempty",
    (gogoproto.moretags) = "yaml:\"hardware_key_challenge\""
  ];
}

// FIDO2ChallengeData contains FIDO2-specific challenge information
message FIDO2ChallengeData {
  option (gogoproto.equal) = true;

  // Challenge is the random challenge bytes
  bytes challenge = 1 [
    (gogoproto.jsontag) = "challenge",
    (gogoproto.moretags) = "yaml:\"challenge\""
  ];

  // RelyingPartyID is the relying party identifier
  string relying_party_id = 2 [
    (gogoproto.jsontag) = "relying_party_id",
    (gogoproto.moretags) = "yaml:\"relying_party_id\""
  ];

  // AllowedCredentials is the list of allowed credential IDs
  repeated bytes allowed_credentials = 3 [
    (gogoproto.jsontag) = "allowed_credentials,omitempty",
    (gogoproto.moretags) = "yaml:\"allowed_credentials\""
  ];

  // UserVerificationRequirement specifies if user verification is required
  string user_verification = 4 [
    (gogoproto.jsontag) = "user_verification",
    (gogoproto.moretags) = "yaml:\"user_verification\""
  ];
}

// OTPChallengeInfo contains OTP tracking information
message OTPChallengeInfo {
  option (gogoproto.equal) = true;

  // DeliveryMethod indicates how the OTP was delivered
  string delivery_method = 1 [
    (gogoproto.jsontag) = "delivery_method",
    (gogoproto.moretags) = "yaml:\"delivery_method\""
  ];

  // DeliveryDestinationMasked is the masked delivery destination
  string delivery_destination_masked = 2 [
    (gogoproto.jsontag) = "delivery_destination_masked",
    (gogoproto.moretags) = "yaml:\"delivery_destination_masked\""
  ];

  // SentAt is when the OTP was sent
  int64 sent_at = 3 [
    (gogoproto.jsontag) = "sent_at",
    (gogoproto.moretags) = "yaml:\"sent_at\""
  ];

  // ResendCount tracks how many times the OTP was resent
  uint32 resend_count = 4 [
    (gogoproto.jsontag) = "resend_count",
    (gogoproto.moretags) = "yaml:\"resend_count\""
  ];

  // LastResendAt is when the OTP was last resent
  int64 last_resend_at = 5 [
    (gogoproto.jsontag) = "last_resend_at,omitempty",
    (gogoproto.moretags) = "yaml:\"last_resend_at\""
  ];
}

// HardwareKeyChallenge represents a challenge for hardware key authentication
message HardwareKeyChallenge {
  option (gogoproto.equal) = true;

  // Challenge is the random challenge bytes to be signed
  bytes challenge = 1 [
    (gogoproto.jsontag) = "challenge",
    (gogoproto.moretags) = "yaml:\"challenge\""
  ];

  // KeyID is the expected key ID to use for signing
  string key_id = 2 [
    (gogoproto.jsontag) = "key_id",
    (gogoproto.moretags) = "yaml:\"key_id\""
  ];

  // Nonce is a random nonce for replay protection
  string nonce = 3 [
    (gogoproto.jsontag) = "nonce",
    (gogoproto.moretags) = "yaml:\"nonce\""
  ];

  // CreatedAt is when the challenge was created
  int64 created_at = 4 [
    (gogoproto.jsontag) = "created_at",
    (gogoproto.moretags) = "yaml:\"created_at\""
  ];
}

// Challenge represents an MFA challenge issued to a user
message Challenge {
  option (gogoproto.equal) = true;

  // ChallengeID is the unique identifier for this challenge
  string challenge_id = 1 [
    (gogoproto.jsontag) = "challenge_id",
    (gogoproto.moretags) = "yaml:\"challenge_id\""
  ];

  // AccountAddress is the account this challenge is for
  string account_address = 2 [
    (cosmos_proto.scalar) = "cosmos.AddressString",
    (gogoproto.jsontag) = "account_address",
    (gogoproto.moretags) = "yaml:\"account_address\""
  ];

  // FactorType is the type of factor this challenge is for
  FactorType factor_type = 3 [
    (gogoproto.jsontag) = "factor_type",
    (gogoproto.moretags) = "yaml:\"factor_type\""
  ];

  // FactorID is the specific factor enrollment being challenged
  string factor_id = 4 [
    (gogoproto.jsontag) = "factor_id",
    (gogoproto.moretags) = "yaml:\"factor_id\""
  ];

  // TransactionType is the sensitive transaction this challenge is for
  SensitiveTransactionType transaction_type = 5 [
    (gogoproto.jsontag) = "transaction_type",
    (gogoproto.moretags) = "yaml:\"transaction_type\""
  ];

  // Status is the current status of the challenge
  ChallengeStatus status = 6 [
    (gogoproto.jsontag) = "status",
    (gogoproto.moretags) = "yaml:\"status\""
  ];

  // ChallengeData contains factor-specific challenge data
  bytes challenge_data = 7 [
    (gogoproto.jsontag) = "challenge_data,omitempty",
    (gogoproto.moretags) = "yaml:\"challenge_data\""
  ];

  // CreatedAt is when the challenge was created
  int64 created_at = 8 [
    (gogoproto.jsontag) = "created_at",
    (gogoproto.moretags) = "yaml:\"created_at\""
  ];

  // ExpiresAt is when the challenge expires
  int64 expires_at = 9 [
    (gogoproto.jsontag) = "expires_at",
    (gogoproto.moretags) = "yaml:\"expires_at\""
  ];

  // VerifiedAt is when the challenge was verified (if successful)
  int64 verified_at = 10 [
    (gogoproto.jsontag) = "verified_at,omitempty",
    (gogoproto.moretags) = "yaml:\"verified_at\""
  ];

  // AttemptCount tracks the number of verification attempts
  uint32 attempt_count = 11 [
    (gogoproto.jsontag) = "attempt_count",
    (gogoproto.moretags) = "yaml:\"attempt_count\""
  ];

  // MaxAttempts is the maximum number of verification attempts allowed
  uint32 max_attempts = 12 [
    (gogoproto.jsontag) = "max_attempts",
    (gogoproto.moretags) = "yaml:\"max_attempts\""
  ];

  // Nonce is a random value for replay protection
  string nonce = 13 [
    (gogoproto.jsontag) = "nonce",
    (gogoproto.moretags) = "yaml:\"nonce\""
  ];

  // SessionID links this challenge to an authorization session
  string session_id = 14 [
    (gogoproto.jsontag) = "session_id,omitempty",
    (gogoproto.moretags) = "yaml:\"session_id\""
  ];

  // Metadata contains additional challenge-specific data
  ChallengeMetadata metadata = 15 [
    (gogoproto.jsontag) = "metadata,omitempty",
    (gogoproto.moretags) = "yaml:\"metadata\""
  ];
}

// ChallengeResponse represents a response to an MFA challenge
message ChallengeResponse {
  option (gogoproto.equal) = true;

  // ChallengeID is the challenge being responded to
  string challenge_id = 1 [
    (gogoproto.jsontag) = "challenge_id",
    (gogoproto.moretags) = "yaml:\"challenge_id\""
  ];

  // FactorType is the type of factor used
  FactorType factor_type = 2 [
    (gogoproto.jsontag) = "factor_type",
    (gogoproto.moretags) = "yaml:\"factor_type\""
  ];

  // ResponseData contains the verification data
  bytes response_data = 3 [
    (gogoproto.jsontag) = "response_data",
    (gogoproto.moretags) = "yaml:\"response_data\""
  ];

  // ClientInfo contains information about the responding client
  ClientInfo client_info = 4 [
    (gogoproto.jsontag) = "client_info,omitempty",
    (gogoproto.moretags) = "yaml:\"client_info\""
  ];

  // Timestamp is when the response was created
  int64 timestamp = 5 [
    (gogoproto.jsontag) = "timestamp",
    (gogoproto.moretags) = "yaml:\"timestamp\""
  ];
}

// AuthorizationSession represents a temporary elevated session after MFA verification
message AuthorizationSession {
  option (gogoproto.equal) = true;

  // SessionID is the unique identifier for this session
  string session_id = 1 [
    (gogoproto.jsontag) = "session_id",
    (gogoproto.moretags) = "yaml:\"session_id\""
  ];

  // AccountAddress is the account this session belongs to
  string account_address = 2 [
    (cosmos_proto.scalar) = "cosmos.AddressString",
    (gogoproto.jsontag) = "account_address",
    (gogoproto.moretags) = "yaml:\"account_address\""
  ];

  // TransactionType is the type of transaction authorized
  SensitiveTransactionType transaction_type = 3 [
    (gogoproto.jsontag) = "transaction_type",
    (gogoproto.moretags) = "yaml:\"transaction_type\""
  ];

  // VerifiedFactors are the factors that were verified for this session
  repeated FactorType verified_factors = 4 [
    (gogoproto.jsontag) = "verified_factors",
    (gogoproto.moretags) = "yaml:\"verified_factors\""
  ];

  // CreatedAt is when the session was created
  int64 created_at = 5 [
    (gogoproto.jsontag) = "created_at",
    (gogoproto.moretags) = "yaml:\"created_at\""
  ];

  // ExpiresAt is when the session expires
  int64 expires_at = 6 [
    (gogoproto.jsontag) = "expires_at",
    (gogoproto.moretags) = "yaml:\"expires_at\""
  ];

  // UsedAt is when the session was used (if single-use)
  int64 used_at = 7 [
    (gogoproto.jsontag) = "used_at,omitempty",
    (gogoproto.moretags) = "yaml:\"used_at\""
  ];

  // IsSingleUse indicates if the session can only be used once
  bool is_single_use = 8 [
    (gogoproto.jsontag) = "is_single_use",
    (gogoproto.moretags) = "yaml:\"is_single_use\""
  ];

  // DeviceFingerprint is the device this session is bound to
  string device_fingerprint = 9 [
    (gogoproto.jsontag) = "device_fingerprint,omitempty",
    (gogoproto.moretags) = "yaml:\"device_fingerprint\""
  ];
}

// TrustedDevice represents a stored trusted device record
message TrustedDevice {
  option (gogoproto.equal) = true;

  // AccountAddress is the account that trusts this device
  string account_address = 1 [
    (cosmos_proto.scalar) = "cosmos.AddressString",
    (gogoproto.jsontag) = "account_address",
    (gogoproto.moretags) = "yaml:\"account_address\""
  ];

  // DeviceInfo contains the device information
  DeviceInfo device_info = 2 [
    (gogoproto.nullable) = false,
    (gogoproto.jsontag) = "device_info",
    (gogoproto.moretags) = "yaml:\"device_info\""
  ];

  // AddedAt is when the device was added
  int64 added_at = 3 [
    (gogoproto.jsontag) = "added_at",
    (gogoproto.moretags) = "yaml:\"added_at\""
  ];

  // LastUsedAt is when the device was last used
  int64 last_used_at = 4 [
    (gogoproto.jsontag) = "last_used_at",
    (gogoproto.moretags) = "yaml:\"last_used_at\""
  ];
}

// SensitiveTxConfig represents the configuration for a sensitive transaction type
message SensitiveTxConfig {
  option (gogoproto.equal) = true;

  // TransactionType is the type of transaction
  SensitiveTransactionType transaction_type = 1 [
    (gogoproto.jsontag) = "transaction_type",
    (gogoproto.moretags) = "yaml:\"transaction_type\""
  ];

  // Enabled indicates if MFA is required for this transaction type
  bool enabled = 2 [
    (gogoproto.jsontag) = "enabled",
    (gogoproto.moretags) = "yaml:\"enabled\""
  ];

  // MinVEIDScore is the minimum VEID score required
  uint32 min_veid_score = 3 [
    (gogoproto.jsontag) = "min_veid_score",
    (gogoproto.moretags) = "yaml:\"min_veid_score\""
  ];

  // RequiredFactorCombinations are the default factor combinations required
  repeated FactorCombination required_factor_combinations = 4 [
    (gogoproto.nullable) = false,
    (gogoproto.jsontag) = "required_factor_combinations",
    (gogoproto.moretags) = "yaml:\"required_factor_combinations\""
  ];

  // SessionDuration is the authorization session duration in seconds
  int64 session_duration = 5 [
    (gogoproto.jsontag) = "session_duration",
    (gogoproto.moretags) = "yaml:\"session_duration\""
  ];

  // IsSingleUse indicates if the authorization is single-use
  bool is_single_use = 6 [
    (gogoproto.jsontag) = "is_single_use",
    (gogoproto.moretags) = "yaml:\"is_single_use\""
  ];

  // AllowTrustedDeviceReduction indicates if trusted devices can reduce MFA
  bool allow_trusted_device_reduction = 7 [
    (gogoproto.jsontag) = "allow_trusted_device_reduction",
    (gogoproto.moretags) = "yaml:\"allow_trusted_device_reduction\""
  ];

  // ValueThreshold is the value threshold for amount-based transactions
  string value_threshold = 8 [
    (gogoproto.jsontag) = "value_threshold,omitempty",
    (gogoproto.moretags) = "yaml:\"value_threshold\""
  ];

  // CooldownPeriod is the cooldown period in seconds for rate-limited operations
  int64 cooldown_period = 9 [
    (gogoproto.jsontag) = "cooldown_period,omitempty",
    (gogoproto.moretags) = "yaml:\"cooldown_period\""
  ];

  // Description provides a human-readable description
  string description = 10 [
    (gogoproto.jsontag) = "description",
    (gogoproto.moretags) = "yaml:\"description\""
  ];
}

// Params defines the parameters for the mfa module
message Params {
  option (gogoproto.equal) = true;
  option (amino.name) = "virtengine/mfa/Params";

  // DefaultSessionDuration is the default MFA session duration in seconds
  int64 default_session_duration = 1 [
    (gogoproto.jsontag) = "default_session_duration",
    (gogoproto.moretags) = "yaml:\"default_session_duration\""
  ];

  // MaxFactorsPerAccount is the maximum number of factors per account
  uint32 max_factors_per_account = 2 [
    (gogoproto.jsontag) = "max_factors_per_account",
    (gogoproto.moretags) = "yaml:\"max_factors_per_account\""
  ];

  // MaxChallengeAttempts is the maximum verification attempts per challenge
  uint32 max_challenge_attempts = 3 [
    (gogoproto.jsontag) = "max_challenge_attempts",
    (gogoproto.moretags) = "yaml:\"max_challenge_attempts\""
  ];

  // ChallengeTTL is the challenge time-to-live in seconds
  int64 challenge_ttl = 4 [
    (gogoproto.jsontag) = "challenge_ttl",
    (gogoproto.moretags) = "yaml:\"challenge_ttl\""
  ];

  // MaxTrustedDevices is the maximum trusted devices per account
  uint32 max_trusted_devices = 5 [
    (gogoproto.jsontag) = "max_trusted_devices",
    (gogoproto.moretags) = "yaml:\"max_trusted_devices\""
  ];

  // TrustedDeviceTTL is the trusted device time-to-live in seconds
  int64 trusted_device_ttl = 6 [
    (gogoproto.jsontag) = "trusted_device_ttl",
    (gogoproto.moretags) = "yaml:\"trusted_device_ttl\""
  ];

  // MinVEIDScoreForMFA is the minimum VEID score to enable MFA
  uint32 min_veid_score_for_mfa = 7 [
    (gogoproto.jsontag) = "min_veid_score_for_mfa",
    (gogoproto.moretags) = "yaml:\"min_veid_score_for_mfa\""
  ];

  // RequireAtLeastOneFactor requires at least one factor when MFA is enabled
  bool require_at_least_one_factor = 8 [
    (gogoproto.jsontag) = "require_at_least_one_factor",
    (gogoproto.moretags) = "yaml:\"require_at_least_one_factor\""
  ];

  // AllowedFactorTypes lists the factor types allowed on this chain
  repeated FactorType allowed_factor_types = 9 [
    (gogoproto.jsontag) = "allowed_factor_types",
    (gogoproto.moretags) = "yaml:\"allowed_factor_types\""
  ];
}

// EventFactorEnrolled is emitted when a factor is enrolled
message EventFactorEnrolled {
  option (gogoproto.equal) = true;

  // AccountAddress is the account that enrolled the factor
  string account_address = 1 [
    (cosmos_proto.scalar) = "cosmos.AddressString",
    (gogoproto.jsontag) = "account_address",
    (gogoproto.moretags) = "yaml:\"account_address\""
  ];

  // FactorType is the type of factor enrolled
  string factor_type = 2 [
    (gogoproto.jsontag) = "factor_type",
    (gogoproto.moretags) = "yaml:\"factor_type\""
  ];

  // FactorID is the ID of the enrolled factor
  string factor_id = 3 [
    (gogoproto.jsontag) = "factor_id",
    (gogoproto.moretags) = "yaml:\"factor_id\""
  ];
}

// EventFactorRevoked is emitted when a factor is revoked
message EventFactorRevoked {
  option (gogoproto.equal) = true;

  // AccountAddress is the account that revoked the factor
  string account_address = 1 [
    (cosmos_proto.scalar) = "cosmos.AddressString",
    (gogoproto.jsontag) = "account_address",
    (gogoproto.moretags) = "yaml:\"account_address\""
  ];

  // FactorType is the type of factor revoked
  string factor_type = 2 [
    (gogoproto.jsontag) = "factor_type",
    (gogoproto.moretags) = "yaml:\"factor_type\""
  ];

  // FactorID is the ID of the revoked factor
  string factor_id = 3 [
    (gogoproto.jsontag) = "factor_id",
    (gogoproto.moretags) = "yaml:\"factor_id\""
  ];
}

// EventChallengeVerified is emitted when a challenge is verified
message EventChallengeVerified {
  option (gogoproto.equal) = true;

  // AccountAddress is the account that verified the challenge
  string account_address = 1 [
    (cosmos_proto.scalar) = "cosmos.AddressString",
    (gogoproto.jsontag) = "account_address",
    (gogoproto.moretags) = "yaml:\"account_address\""
  ];

  // ChallengeID is the ID of the verified challenge
  string challenge_id = 2 [
    (gogoproto.jsontag) = "challenge_id",
    (gogoproto.moretags) = "yaml:\"challenge_id\""
  ];

  // FactorType is the type of factor used
  string factor_type = 3 [
    (gogoproto.jsontag) = "factor_type",
    (gogoproto.moretags) = "yaml:\"factor_type\""
  ];

  // TransactionType is the transaction type that was authorized
  string transaction_type = 4 [
    (gogoproto.jsontag) = "transaction_type",
    (gogoproto.moretags) = "yaml:\"transaction_type\""
  ];
}

// EventMFAPolicyUpdated is emitted when an MFA policy is updated
message EventMFAPolicyUpdated {
  option (gogoproto.equal) = true;

  // AccountAddress is the account whose policy was updated
  string account_address = 1 [
    (cosmos_proto.scalar) = "cosmos.AddressString",
    (gogoproto.jsontag) = "account_address",
    (gogoproto.moretags) = "yaml:\"account_address\""
  ];

  // Enabled indicates if MFA is now enabled
  bool enabled = 2 [
    (gogoproto.jsontag) = "enabled",
    (gogoproto.moretags) = "yaml:\"enabled\""
  ];
}
