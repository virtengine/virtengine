// Code generated by protoc-gen-go. DO NOT EDIT.
// versions:
// 	protoc-gen-go v1.32.0
// 	protoc        v4.25.1
// source: pkg/inference/proto/inference.proto
//
// Package inferencepb provides types and interfaces for the VEID inference sidecar.
// VE-219: Deterministic identity verification runtime

package inferencepb

// HealthStatus represents the health status of the inference service.
type HealthStatus int32

const (
	HealthStatus_HEALTH_STATUS_UNSPECIFIED HealthStatus = 0
	HealthStatus_HEALTH_STATUS_HEALTHY     HealthStatus = 1
	HealthStatus_HEALTH_STATUS_DEGRADED    HealthStatus = 2
	HealthStatus_HEALTH_STATUS_UNHEALTHY   HealthStatus = 3
)

// String returns the string representation of the health status.
func (h HealthStatus) String() string {
	switch h {
	case HealthStatus_HEALTH_STATUS_HEALTHY:
		return "HEALTHY"
	case HealthStatus_HEALTH_STATUS_DEGRADED:
		return "DEGRADED"
	case HealthStatus_HEALTH_STATUS_UNHEALTHY:
		return "UNHEALTHY"
	default:
		return "UNSPECIFIED"
	}
}

// DeterminismConfig describes how determinism is enforced.
type DeterminismConfig struct {
	// ForceCPU forces CPU-only execution (no GPU)
	ForceCPU bool `json:"force_cpu,omitempty"`

	// RandomSeed is the fixed random seed for all operations
	RandomSeed int64 `json:"random_seed,omitempty"`

	// InterOpParallelism is the number of inter-op threads (1 for determinism)
	InterOpParallelism int32 `json:"inter_op_parallelism,omitempty"`

	// IntraOpParallelism is the number of intra-op threads (1 for determinism)
	IntraOpParallelism int32 `json:"intra_op_parallelism,omitempty"`

	// DeterministicOps forces use of deterministic operation implementations
	DeterministicOps bool `json:"deterministic_ops,omitempty"`
}

// GetModelInfoRequest is the request for GetModelInfo RPC.
type GetModelInfoRequest struct{}

// GetModelInfoResponse is the response from GetModelInfo RPC.
type GetModelInfoResponse struct {
	// Version is the semantic version of the model (e.g., "v1.0.0")
	Version string `json:"version,omitempty"`

	// Hash is the SHA256 hash of the model weights
	Hash string `json:"hash,omitempty"`

	// InputDim is the expected input feature vector dimension
	InputDim int32 `json:"input_dim,omitempty"`

	// OutputDim is the output dimension
	OutputDim int32 `json:"output_dim,omitempty"`

	// TensorFlowVersion is the TensorFlow version used for export
	TensorFlowVersion string `json:"tensorflow_version,omitempty"`

	// ExportTimestamp is when the model was exported (RFC3339)
	ExportTimestamp string `json:"export_timestamp,omitempty"`

	// PipelineVersion is the overall ML pipeline version
	PipelineVersion string `json:"pipeline_version,omitempty"`

	// DeterminismConfig contains determinism configuration details
	DeterminismConfig *DeterminismConfig `json:"determinism_config,omitempty"`
}

// InferenceMetadata contains contextual information about an inference request.
type InferenceMetadata struct {
	// AccountAddress is the blockchain address being verified
	AccountAddress string `json:"account_address,omitempty"`

	// BlockHeight is the current block height
	BlockHeight int64 `json:"block_height,omitempty"`

	// RequestID is a unique identifier for this request
	RequestID string `json:"request_id,omitempty"`

	// ValidatorAddress is the address of the validator performing inference
	ValidatorAddress string `json:"validator_address,omitempty"`
}

// GetAccountAddress returns the account address or empty string if nil.
func (m *InferenceMetadata) GetAccountAddress() string {
	if m == nil {
		return ""
	}
	return m.AccountAddress
}

// GetBlockHeight returns the block height or 0 if nil.
func (m *InferenceMetadata) GetBlockHeight() int64 {
	if m == nil {
		return 0
	}
	return m.BlockHeight
}

// GetRequestID returns the request ID or empty string if nil.
func (m *InferenceMetadata) GetRequestID() string {
	if m == nil {
		return ""
	}
	return m.RequestID
}

// GetValidatorAddress returns the validator address or empty string if nil.
func (m *InferenceMetadata) GetValidatorAddress() string {
	if m == nil {
		return ""
	}
	return m.ValidatorAddress
}

// ComputeScoreRequest is the request for ComputeScore RPC.
type ComputeScoreRequest struct {
	// Features is the input feature vector
	Features []float32 `json:"features,omitempty"`

	// Metadata contains contextual information
	Metadata *InferenceMetadata `json:"metadata,omitempty"`

	// ReturnContributions requests feature contribution breakdown
	ReturnContributions bool `json:"return_contributions,omitempty"`
}

// ComputeScoreResponse is the response from ComputeScore RPC.
type ComputeScoreResponse struct {
	// Score is the quantized identity score (0-100)
	Score uint32 `json:"score,omitempty"`

	// RawScore is the raw model output before quantization
	RawScore float32 `json:"raw_score,omitempty"`

	// Confidence is the model's confidence in the prediction (0.0-1.0)
	Confidence float32 `json:"confidence,omitempty"`

	// InputHash is the SHA256 hash of the input features
	InputHash string `json:"input_hash,omitempty"`

	// OutputHash is the SHA256 hash of the raw output
	OutputHash string `json:"output_hash,omitempty"`

	// ModelVersion is the version of the model
	ModelVersion string `json:"model_version,omitempty"`

	// ModelHash is the SHA256 hash of the model weights
	ModelHash string `json:"model_hash,omitempty"`

	// ReasonCodes explain factors contributing to the score
	ReasonCodes []string `json:"reason_codes,omitempty"`

	// ComputeTimeMs is the inference computation time in milliseconds
	ComputeTimeMs int64 `json:"compute_time_ms,omitempty"`

	// FeatureContributions maps feature names to contribution scores
	FeatureContributions map[string]float32 `json:"feature_contributions,omitempty"`
}

// HealthCheckRequest is the request for HealthCheck RPC.
type HealthCheckRequest struct{}

// HealthCheckResponse is the response from HealthCheck RPC.
type HealthCheckResponse struct {
	// Status indicates the service health status
	Status HealthStatus `json:"status,omitempty"`

	// ModelLoaded indicates if the model is successfully loaded
	ModelLoaded bool `json:"model_loaded,omitempty"`

	// ModelVersion is the loaded model version
	ModelVersion string `json:"model_version,omitempty"`

	// ModelHash is the loaded model hash
	ModelHash string `json:"model_hash,omitempty"`

	// UptimeSeconds is how long the service has been running
	UptimeSeconds int64 `json:"uptime_seconds,omitempty"`

	// LastInferenceTimestamp is when the last inference was performed
	LastInferenceTimestamp string `json:"last_inference_timestamp,omitempty"`

	// ErrorMessage contains details if status is not HEALTHY
	ErrorMessage string `json:"error_message,omitempty"`
}

// GetMetricsRequest is the request for GetMetrics RPC.
type GetMetricsRequest struct{}

// GetMetricsResponse is the response from GetMetrics RPC.
type GetMetricsResponse struct {
	// TotalInferences is the total number of inference requests
	TotalInferences uint64 `json:"total_inferences,omitempty"`

	// SuccessfulInferences is the number of successful inferences
	SuccessfulInferences uint64 `json:"successful_inferences,omitempty"`

	// FailedInferences is the number of failed inferences
	FailedInferences uint64 `json:"failed_inferences,omitempty"`

	// AverageLatencyMs is the average inference latency in milliseconds
	AverageLatencyMs float32 `json:"average_latency_ms,omitempty"`

	// P99LatencyMs is the 99th percentile latency in milliseconds
	P99LatencyMs float32 `json:"p99_latency_ms,omitempty"`

	// ModelVersion is the current model version
	ModelVersion string `json:"model_version,omitempty"`

	// ModelHash is the current model hash
	ModelHash string `json:"model_hash,omitempty"`

	// UptimeSeconds is how long the service has been running
	UptimeSeconds int64 `json:"uptime_seconds,omitempty"`

	// MemoryUsageMB is the current memory usage in megabytes
	MemoryUsageMB float32 `json:"memory_usage_mb,omitempty"`

	// LatencyHistogram contains latency distribution buckets
	LatencyHistogram map[string]uint64 `json:"latency_histogram,omitempty"`
}

// VerifyDeterminismRequest is the request for VerifyDeterminism RPC.
type VerifyDeterminismRequest struct {
	// TestVectorID is the ID of the test vector to use
	TestVectorID string `json:"test_vector_id,omitempty"`

	// CustomInput is a custom input for verification
	CustomInput []float32 `json:"custom_input,omitempty"`

	// ExpectedOutputHash is the expected output hash
	ExpectedOutputHash string `json:"expected_output_hash,omitempty"`
}

// VerifyDeterminismResponse is the response from VerifyDeterminism RPC.
type VerifyDeterminismResponse struct {
	// Passed indicates if the determinism check passed
	Passed bool `json:"passed,omitempty"`

	// ActualOutputHash is the hash of the output produced
	ActualOutputHash string `json:"actual_output_hash,omitempty"`

	// ExpectedOutputHash is the expected hash
	ExpectedOutputHash string `json:"expected_output_hash,omitempty"`

	// Differences contains descriptions of any differences found
	Differences []string `json:"differences,omitempty"`

	// TestVectorID is the ID of the test vector used
	TestVectorID string `json:"test_vector_id,omitempty"`
}
