# Pod Chaos Experiments for VirtEngine
# These experiments test pod failure and recovery scenarios

---
# Validator Pod Kill: Kill a single validator pod
apiVersion: chaos-mesh.org/v1alpha1
kind: PodChaos
metadata:
  name: validator-pod-kill
  namespace: chaos-testing
  labels:
    chaos.virtengine.io/category: pod
    chaos.virtengine.io/scenario: kill
spec:
  action: pod-kill
  mode: one
  selector:
    namespaces:
      - virtengine
    labelSelectors:
      app.kubernetes.io/component: validator

---
# Validator Pod Failure: Simulate pod crash
apiVersion: chaos-mesh.org/v1alpha1
kind: PodChaos
metadata:
  name: validator-pod-failure
  namespace: chaos-testing
  labels:
    chaos.virtengine.io/category: pod
    chaos.virtengine.io/scenario: failure
spec:
  action: pod-failure
  mode: one
  selector:
    namespaces:
      - virtengine
    labelSelectors:
      app.kubernetes.io/component: validator
  duration: "60s"

---
# Provider Daemon Pod Kill: Kill provider daemon
apiVersion: chaos-mesh.org/v1alpha1
kind: PodChaos
metadata:
  name: provider-pod-kill
  namespace: chaos-testing
  labels:
    chaos.virtengine.io/category: pod
    chaos.virtengine.io/scenario: kill
spec:
  action: pod-kill
  mode: one
  selector:
    namespaces:
      - virtengine
    labelSelectors:
      app.kubernetes.io/component: provider-daemon

---
# Container Kill: Kill specific container in pod
apiVersion: chaos-mesh.org/v1alpha1
kind: PodChaos
metadata:
  name: validator-container-kill
  namespace: chaos-testing
  labels:
    chaos.virtengine.io/category: pod
    chaos.virtengine.io/scenario: container-kill
spec:
  action: container-kill
  mode: one
  selector:
    namespaces:
      - virtengine
    labelSelectors:
      app.kubernetes.io/component: validator
  containerNames:
    - virtengine

---
# Rolling Pod Failure: Sequential pod failures
apiVersion: chaos-mesh.org/v1alpha1
kind: PodChaos
metadata:
  name: validator-rolling-failure
  namespace: chaos-testing
  labels:
    chaos.virtengine.io/category: pod
    chaos.virtengine.io/scenario: rolling
spec:
  action: pod-kill
  mode: fixed-percent
  value: "25"
  selector:
    namespaces:
      - virtengine
    labelSelectors:
      app.kubernetes.io/component: validator

---
# Multi-validator Failure: Kill multiple validators
apiVersion: chaos-mesh.org/v1alpha1
kind: PodChaos
metadata:
  name: multi-validator-failure
  namespace: chaos-testing
  labels:
    chaos.virtengine.io/category: pod
    chaos.virtengine.io/scenario: multi-failure
spec:
  action: pod-kill
  mode: fixed
  value: "2"
  selector:
    namespaces:
      - virtengine
    labelSelectors:
      app.kubernetes.io/component: validator
